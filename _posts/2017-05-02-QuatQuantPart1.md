---
layout: post
title:   'Quaternion quantization: part 1'
tagline: 'unconstrained/context free'
categories: [quaternions]
tags : [quantization, rotations, frames, graphics]
description : An overview of full-range context-free quantization of quaternions into fixed bit package.
plotly: true
---

------

Prelim
------

\\
I going to run through some basic quaternion quantization and only considers the worst case situation in terms of error vs. size:

* We have no context or prediction
* We have no known probability distributations
* We only consider quantization/reconstruction (no entropy coding, performace issues, etc)
* Fixed sized bit-package

\\
Basically we will assume that the quaternions being quantized are from a uniform random source with no restrictions. Or another way they are from an IID point sequence on the 3-sphere.  Given this toy problem statement I will consider the important metric be minimal peak magnitude error.

Minimal notation summary:  I will write a unit quaternion as:

$$
\begin{eqnarray*}
Q &=& a + \left(x,~y,~z\right) \\
  &=& a + b~\mathbf{u} \\
  &=& \cos\left(\theta\right) + \sin\left(\theta\right)~\mathbf{u}
\end{eqnarray*}
$$

\\
So scalars are lowercase, I put the scalar part first, lowercase bold face for 3D (bi)vectors and I use radian angle measures in $\mathbb{H}$ and not $\mathbb{R}^3$ *except* all error values which will be in degrees in $\mathbb{R}^3$.  I will also assume that the scalar is positive, if not the sign of it will need to be carried through.

The following table is a recap of the Half-angle/Cayley transform post[^hangle]:

<br>

{: .center }
| Name        | Equation    |  $d\left(\theta\right)$  | $ d\'\left(\theta\right) $ | max RT error |
|:------------|:-----------:|:-----------:|:-----------:|:-----------:|
| identity (projected)     | $\left<Q\right>_2$   | $\sin\left(\theta\right) $|$\cos\left(\theta\right) $ | 0.055939 |
| half-angle (projected)     | $\left<\sqrt{Q}\right>_2$   | $\sin\left(\frac{\theta}{2}\right) $|$\frac{1}{2} \cos\left(\frac{\theta}{2}\right) $ | 0.000075 |
| Cayley transform | $\left(Q-1\right)\left(Q+1\right)^{-1}$ | $\tan\left(\frac{\theta}{2}\right) $ | $\frac{1}{2} \cos\left(\frac{\theta}{2}\right)^{-2} $| 0.000045 |
| harmonic mean   | $\left(\sqrt{Q}-1\right)\left(\sqrt{Q}+1\right)^{-1}$  | $\tan\left(\frac{\theta}{4}\right) $ | $\frac{1}{4} \cos\left(\frac{\theta}{4}\right)^{-2} $| 0.000070 |
| exponential map | $\log Q$  | $\theta$ | 1 | 0.000087 |


\\
Where bivector extraction (rank-2) is denoted and expressed algebraically:

$$
\left<Q\right>_2 = \frac{1}{2}\left(Q-Q^*\right)
$$

All the transforms map a unit quaternion to a point in a 3D ball in the direction of the axis of rotation.  I'll refer to this type of transform as *ball maps*.  The table entries are: 

* Distance from the origin of $\theta$ is $d\left(\theta\right)$, which is the cumlative density.
* The derivative $ d\'\left(\theta\right) $ is the density.
* *max RT error* is the maximum round trip error[^rterror] (without quantization) measured in $\mathbb{R}^3$ and in degrees.

Toy/proof-of-concept C code: [here](http://github.com/Marc-B-Reynolds/Stand-alone-junk/blob/master/src/Posts/quatquant0.c)

<br>

------

Aside: in memory compression <small>4:3</small>
------

\\
Other than identity (drop and reconstruct the scalar) any of the ball maps perform pretty well at round tripping between 3 and 4 component representations.  Performance of runtime transform(s) and if the reverse can be folded with the next operation are probably more interesting considerations.

<br>

------

Smallest three
------

\\
One existing method of quantizing quaternions is called *smallest three*.  This does exactly what it says: determine the component with the maximum magnitude, note which one it is and store the other three components (negated if the largest is negative). This side-line information requires two bits of storage. For whatever it's worth we can think of this geometically as performing one of four isoclinic rotations by $1, \mathbf{x}, \mathbf{y}$ and $\mathbf{z}$.

The shape generated by this mapping in our case is that of a ball of radius $\frac{\sqrt{2}}{2}$ when then the scalar is the largest component (implied angle is on $\left[0,\frac{\pi}{2}\right]$). Beyond that point the scalar becomes one of the encoded values and the largest bivector component is dropped.  This in turn fills the ball and then "inflates" slightly beyond.  I haven't bothered to formulate an equation for the surface but roughly speaking if we put an axe aligned bounding box around the ball then slightly inflate within that contraint is roughly the surface.  The approximate volume once we've scaled up to unit extent is 5.35284 which translates to using ~66.9% of the quantization space vs ~52.4% for the unit ball assuming uniform grid as we'll start with.


<br>

------

Tait-Bryan ZYX and Euler ZXZ
------

\\
In a prequel post[^tait] I ran through the basic math and some computation issues wrt to error for both of these system. 

<div class="alert alert-danger" role="alert">
<strong>Danger!:</strong> Seemly standard methods of conversion introduce more error than quantization.  See the post for details if you using any Euler angle like parameterization.
</div>

An upside to both of these is they use all of the quantization space without any extra effort.  The downside is they are computationally expensive for both encode and decode. Notiably (as presented) converting to ZYX requires two two parameter atans and one one parameter and produces:

$$
\theta \in \left[-\frac{\pi}{2},\frac{\pi}{2}\right] \\ \phi,\psi \in \left[-\pi,\pi\right]
$$

Converting to ZXZ is slightly nicer only requiring one two parameter atan and two single parameter.  However the formulation that I gave in that post does not produce minimal range angles, specifically returning:

$$
\beta \in \left[0, \pi \right] \\ \alpha,\gamma \in \left[-\frac{3\pi}{2},\frac{3\pi}{2}\right]
$$

So $\alpha$ and $\gamma$ need to be reduced to $\left[-\pi,\pi\right]$. Reducing the values to range can be folded with the argument reduction of the two parameter atan, which I'll ignore for the moment.

If either of these methods are determined to be of interest we can examine its error performance and potentially replace the arctangents and/or forward trig operations with lower accurancy approximations.

<br>

------

Skip-ahead
------

The next few sections are simply a recap of the transforms in the half-angle/Cayley post combined with scaling to the unit ball.  So you might want to simply skip to *"Example configuration and results"* section.

<br>

------

Basic half-angle <small>$\left<\sqrt{Q}\right>_2$<small>
------

\\
Recall if we take the square-root of a unit quaternion ($Q$) we half its implied angle and we can reverse this by squaring.  By choosing $Q$ with a zero or positive scalar this insures that the scalar ($w$) is the largest component so it can be dropped. The result is a radius $\sin\left(\frac{\theta_m}{2}\right)$ ball which in our case is $\frac{1}{\sqrt{2}}$.  We can rescaling the equation so we are mapping to the unit ball.

The forward and inverse transform pairs then become:

$$
Q = w + \left(x,~y,~z\right) \rightarrow \frac{1}{\sqrt{1+w}} \left(x,~y,~z\right) = p
$$

$$
p = \left(x,~y,~z\right) \rightarrow  \left(1-p \cdot p \right) +  \sqrt{2-p \cdot p} \left(x,~y,~z\right) = Q
$$

\\
GLSL code snippets for the forward and inverse transforms (assuming $w$ is already positive)[^pos]:

{% highlight c %}

vec3 quat_fha(vec4 q)
{
  float s = inversesqrt(1.0+q.w);
  return s*q.xyz;
}

vec4 quat_iha(vec3 p)
{
  float d = dot(p,p);
  float s = sqrt(2.0-d);
  return vec4(s*p.xyz, 1.0-d);
}
{% endhighlight %}

<br>

------

Basic Cayley <small>$\left(Q-1\right)\left(Q+1\right)^{-1}$</small>
------

\\
The Cayley transform maps a unit quaternion with a zero/positive scalar to a ball with radius $\tan\left(\frac{\theta_m}{2}\right)$ which is the unit ball in the case we are considering. The forward and inverse transforms are:


$$
Q = w + \left(x,~y,~z\right) \rightarrow \frac{1}{1+w} \left(x,~y,~z\right) = p
$$

$$
p = \left(x,~y,~z\right) \rightarrow  \left(1-\frac{2}{1+p \cdot p}\right) +  \frac{2}{1+p \cdot p} \left(x,~y,~z\right) = Q
$$

\\
GLSL code snippets for the forward and inverse transforms (assuming $w$ is already positive)[^pos]:

{% highlight c %}
vec3 quat_fct(vec4 q)
{
  float s = 1.0/(1.0+q.w);
  return s*q.xyz;
}

vec4 quat_ict(vec3 v)
{
  float s = 2.0/(1.0+dot(v,v));
  return vec4(s*v.xyz, 1.0-s);
}
{% endhighlight %}


<br>

------

Basic harmonic mean <small>$\left(\sqrt{Q}-1\right)\left(\sqrt{Q}+1\right)^{-1}$</small>
------

\\
The harmonic mean is the compostion of half-angle followed by Cayley.  This produces a radius $\tan\left(\frac{\theta_m}{4}\right)$ ball which in our case is: $\sqrt{2}-1$.

Rescaling to the unit ball gives the forward and inverse transform pairs:

$$
Q = w + \left(x,~y,~z\right) \rightarrow \frac{1+\sqrt{2}}{1+w+\sqrt{2+2w}} \left(x,~y,~z\right) = p
$$

$$
p = \left(x,~y,~z\right) \rightarrow  \frac{1-6a+a^2}{\left(1+a\right)^2} +
\frac{4\left(\sqrt{2}-1\right)\left(1-a\right)}{\left(1+a\right)^2}\left(x,~y,~z\right) = Q
$$

where:

$$
\begin{eqnarray*}
a &=& \left(3-2\sqrt{2}\right)p \cdot p
\end{eqnarray*}
$$

\\
GLSL code snippets for the forward and inverse transforms (assuming $w$ is already positive)[^pos]:


{% highlight c %}

const float Km  = 4.0*(0.4142135679721832275390625); // 4(sqrt(2)-1)
const float Khf = 2.414213657379150390625;           // sqrt(2)+1 = 1/(sqrt(2)-1)
const float Khi = 0.17157287895679473876953125;      // 3-2sqrt(2)

vec3 quat_fhm(vec4 q)
{
  float s = Khf/(1.0+q.w+sqrt(2.0+2.0*q.w));
  return s*q.xyz;
}

vec4 quat_ihm(vec3 v)
{
  float d = Khi*dot(v,v);
  float a = (1.0+d);
  float b = (1.0-d)*Km;
  float c = 1.0/(a*a);
  vec4  q;
  
  q.xyz = v*b*c;
  q.w   = (1.0+d*(d-6.0))*c;
}
{% endhighlight %}


<br>

------

Basic exponential map <small>$\log Q$</small>
------

\\
Taking the logarithm produces a $\theta_m$ radius ball, so in our case we have $\frac{\pi}{2}$.

Rescaling to the unit ball gives the forward and inverse transform pairs:

$$
Q = w + \left(x,~y,~z\right) \rightarrow \frac{\frac{2}{\pi}~ \text{atan}\left(\frac{\sqrt{1-w^2}}{w}\right)}{\sqrt{1-w^2}} \left(x,~y,~z\right) = p
$$

$$
p = \left(x,~y,~z\right) \rightarrow \cos \left(\frac{\pi}{2} \sqrt{p \cdot p}\right) +  \frac{\sin\left( \frac{\pi}{2} \sqrt{p \cdot p} \right)}{ \frac{\pi}{2} \sqrt{p \cdot p}}
	\left(x,~y,~z\right) = Q
$$


\\
GLSL code snippets for the forward and inverse transforms (assuming $w$ is already positive)[^pos]:

{% highlight c %}
vec3 quat_fem(vec4 q)
{
  float w = q.w;
  float a = 1.0-w*w;
  float b = inversesqrt(a+EPS);
  float k = a*b;
  float s = (2.0/PI)*atan(k/w)*b;
  return s*v;
}

vec4 quat_iem(vec3 v)
{
  float d = dot(v,v);
  float t = inversesqrt(d+EPS);
  float a = (PI/2.0)*t*d;
  float s = sin(a);
  float k = s*t;
  return vec4(k*v.xyz, cos(a));
}
{% endhighlight %}

<br>

------

Example configuration and results
------

\\
Now let's look at some basic quantization with:

* allowing an arbitrary number of bits in the fixed package (not requiring each component to have equal number of bits)
* linear quantized with round to negative infinity for quant and center reconstruct for dequant. This choice means we cannot exactly represent zero and therefore identity. I'm not considering this a problem since this post isn't useful for relative/update information.
* on the standard integer lattice (Cartesian/uniform grid)

Let's examine how the maximum error globally behaves as we add bits to each transform, starting from 9 up to 32 bits. If we have a $n$ bit package and $n \bmod 3 = 1$ then the last component gets an extra bit and if $n \bmod 3 = 2$ then the last two get an extra bit each. As a log plot we get:

<div id="fig1" style="width:100%"></div>

\\
The overall is that this follows the reasonable expectation that the error should approximately linearly decrease in a log-plot since adding a bit doubles the number of representable values. We can also see that ZYX and ZXZ are very close with ZXZ always the slightly better.  Since quaternion to ZXZ can be formulated with lower runtime cost than ZYX we can stop considering ZYX.  If we examine the methods with the lowest error at each bit size we will notice a pattern emerges.  A table of the top three:

<br>

{: .center }
| $n \bmod 3$ | best |  second | third |
|:-----------:|:-----------:|:---------:|:-----------:|
| 0           | exp-map | harmonic-mean | ZXZ |
| 1           | exp-map | ZXZ           | harmonic-mean |
| 2           | ZXZ     | exp-map       | harmonic-mean |

\\
Now let's take the previous graph and view the relative effectiveness of adding a bit $\left(\frac{\text{error}\left(n+1\right)}{\text{error}\left(n\right)}\right)$:

<div id="fig1a" style="width:100%"></div>

This is a bit of a mess because half-angle isn't well behaved here.  Click on it in the legend to turn off that trace.  Now the graph is pretty much two sets of traces: ZXZ vs. the ball maps and the $n \bmod 3$ behavior is clear.  

{: .center }
| $n \bmod 3$ |   maps |  ZXZ  |
|:-----------:|:------:|:------:|
| 0           | 0.7071 | 0.9220 |
| 1           | 0.8660 | 0.7670 |
| 2           | 0.8165 | 0.7071 |

\\
For the ball maps all three components are equally important so the largest improvement is when the points form a cube (mod is zero).  ZXZ has one angle with half the range so it's best is when mod is 2.  Adding three bits halves the error for both types.

Although the toy problem statement only cares about global peak error let's go ahead and examine error as a function of rotation angle.  If we re-examine the density function from Half-angle/Cayley post we expect that higher density should result in lower errors:

<div id="fig3" style="width:100%"></div>

Now a sequence of error vs rotation angle plots for each mod n behavior:

<div id="fig2a" style="width:100%"></div>
<div id="fig2b" style="width:100%"></div>
<div id="fig2c" style="width:100%"></div>

\\
These plots still don't show the whole picture. The part we are ignoring (for ball maps) is the impact of the direction of the bivector (axis of rotation). Some things to note:

* error plots of the ball maps are inversely related to density as expected and they behave the same regardless of bit-size
* ZYZ in it's various position in the top three
* I'm showing identity map projected to ball which is useless for full range input.  The point of including it is to compare with smallest-three. Specifically in the 32-bit case there's only mimimal impact to error on the range where they are the same transform. So sideline information can be effective espectially when they are replacing what would otherwise be less effective given the bit allocation.

\\
Ideally I would now show some 3D density (heat-map) plots on the unit ball with a cut-out for the various ball maps.  I'm too lazy to do that ATM, so instead let's look at best and worst case directions.  The issue is our quantization space is currently a cube with a volume of eight, we're mapping to a unit ball (volume $\frac{4}{3}\pi \approx 4.189$) so we are wasting $1-\frac{\pi}{6}$ or approximately 47.6% of the space.  If we have $n$ sample in one extent, then that's how many we'll pass for an axial aligned rotation and only $\frac{1}{\sqrt{3}}n$ if the axis is along a diagonal (and they're farther apart).  A 12-bit encoding of the exponential map clearly shows:

<div id="fig5" style="width:100%"></div>

For ball maps with 30 bit encoding:

<div id="fig4" style="width:100%"></div>

Note the behaviour of the half-angle transform (click away the others). We can leave aligned quantization points alone and improve along the diagonal by adding radial stretching to the encode/decode.  The global, along x and diagonal now look like:

<div id="fig6" style="width:100%"></div>

The error along the diagonal has been overkill reduced.  It seems likely some tweaks could produce a better global result by moving some of the point away from the diagonal toward higher peak error directions, but I'm not going to make the effort without looking at some density plots.  Let's look at half-angle plus radial stretch vs. the previous top performing methods at 30, 31 and 32-bit packages:

<div id="fig6a" style="width:100%"></div>
<div id="fig6b" style="width:100%"></div>
<div id="fig6c" style="width:100%"></div>

So half-angle + radial stretch takes over the top spot for 30-bit, is very close second at 31-bits and loses it completely for 32-bit packages. Recall that half-angle isn't well behaved at $n \bmod 3$ effectiveness, so these different package size choice will vary.

Smallest-three encoded with 32-bits shows that someone motivated could probably give it a nice bump in a similar manner.

<div id="fig4a" style="width:100%"></div>

<br>

------

Breaking point
------

That's enough for one post.  I do have some more bits and pieces on this topic before moving to context and prediction based.

<br>

------

References and Footnotes
------


[^pos]:     Otherwise replace $w$ by $\abs{w}$ and add $\text{sgn}\left(w\right)$ to the final scale value.  In this case the inverse transform returns $-Q$ when $w$ is negative.
[^hangle]: "Quaternion half/double angle and Cayley transforms" ([local post]({{site.base}}/quaternions/2016/06/06/QuatNormal.html))
[^rterror]: Measured using the toy C implemenations.
[^tait]:    "Converting to Euler & Tait-Bryan" ([local post]({{site.base}}//math/2017/04/18/TaitEuler.html))
<script>

var mDef = {size:6, opacity:.75};

// global per bit figure
var emm =[38.971165,33.749950,27.556702,19.485600,16.874952,13.778322,9.742805,8.437453,6.889132,4.871422,4.218703,3.444536,2.435746,2.109328,1.722244,1.217906,1.054678,0.861145,0.608971,0.527343,0.430574,0.304509,0.263689,0.215304];
var hmm =[40.996521,35.527676,29.027576,20.539322,17.790541,14.528332,10.274802,8.898602,7.265967,5.138030,4.449701,3.633189,2.569079,2.224884,1.816599,1.284537,1.112443,0.908312,0.642286,0.556238,0.454170,0.321146,0.278123,0.227089];
var ham =[49.128521,45.754223,36.436169,24.505112,21.550680,17.412024,12.427742,10.577335,8.661926,6.129381,5.235823,4.271895,3.044705,2.644503,2.124865,1.537244,1.311331,1.060487,0.772422,0.655832,0.529552,0.387209,0.325872,0.262110];
var ctm =[48.865364,42.478584,34.815990,24.713531,21.423262,17.508987,12.392774,10.735063,8.767263,6.200903,5.370458,4.385213,3.101003,2.685579,2.192784,1.550556,1.342816,1.096394,0.775292,0.671421,0.548212,0.387654,0.335721,0.274119];
var stm=[60.287365,43.289040,45.065338,35.323318,25.923468,17.380363,14.970781,11.890102,8.647225,7.208056,5.740692,4.185228,3.511044,2.822723,2.192546,1.840758,1.476877,1.088605,0.914904,0.734419,0.550327,0.462847,0.372054,0.274583];
var tbm=[46.314007,35.523838,25.123322,23.183693,17.781382,12.573844,11.595145,8.893113,6.288459,5.797998,4.446870,3.144420,2.899061,2.223483,1.572240,1.449537,1.111741,0.786122,0.724776,0.555871,0.393059,0.362390,0.277945,0.196535];
var eam=[46.313969,35.523823,25.123310,23.183676,17.781382,12.573832,11.595131,8.893090,6.288420,5.797971,4.446841,3.144405,2.899039,2.223459,1.572221,1.449520,1.111729,0.786108,0.724759,0.555865,0.393055,0.362380,0.277932,0.196527];

var xc = [9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32];

var pemm = {y:emm, x:xc, name:'exp-map',type: 'scatter', mode:'markers', marker: mDef};
var phmm = {y:hmm, x:xc, name:'h-mean', type: 'scatter', mode:'markers', marker: mDef};
var pham = {y:ham, x:xc, name:'h-angle',type: 'scatter', mode:'markers', marker: mDef};
var pctm = {y:ctm, x:xc, name:'Cayley', type: 'scatter', mode:'markers', marker: mDef};
var pstm = {y:stm, x:xc, name:'ST',     type: 'scatter', mode:'markers', marker: mDef};
var ptbm = {y:tbm, x:xc, name:'ZYX',    type: 'scatter', mode:'markers', marker: mDef};
var peam = {y:eam, x:xc, name:'ZXZ',    type: 'scatter', mode:'markers', marker: mDef};

var basic = [ptbm,peam,pemm,phmm,pham,pctm,pstm];

// per bit improvement figure
var xbp  = new Array(23);
var embp = new Array(23);
var hmbp = new Array(23);
var habp = new Array(23);
var ctbp = new Array(23);
var stbp = new Array(23);
var tbp  = new Array(23);

var pbem = {y:embp, x:xbp, name:'exp-map', type: 'scatter', mode:'markers', marker: mDef};
var pbhm = {y:hmbp, x:xbp, name:'h-mean',  type: 'scatter', mode:'markers', marker: mDef};
var pbha = {y:habp, x:xbp, name:'h-angle', type: 'scatter', mode:'markers', marker: mDef};
var pbct = {y:ctbp, x:xbp, name:'Cayley',  type: 'scatter', mode:'markers', marker: mDef};
var pbst = {y:ctbp, x:xbp, name:'ST',      type: 'scatter', mode:'markers', marker: mDef};
var pbtb = {y:tbp,  x:xbp, name:'ZXZ',     type: 'scatter', mode:'markers', marker: mDef};
var bp   = [pbtb,pbem,pbhm,pbha,pbct,pbst];

{
  for(var i=0; i<23; i++) {
    embp[i] = emm[i+1]/emm[i];
    hmbp[i] = hmm[i+1]/hmm[i];
    habp[i] = ham[i+1]/ham[i];
    ctbp[i] = ctm[i+1]/ctm[i];
    stbp[i] = stm[i+1]/stm[i];
    tbp[i]  = tbm[i+1]/tbm[i];

	xbp[i]  = i+1;
  }
}

var bpLayout = { 
  title:  'additional bit effectiveness',
  height: 500,
  width:  800
};

Plotly.newPlot('fig1a', bp, bpLayout, {displaylogo: false, autosizable: true});

// basic by angle values (30-bit)

var em30 = [0.304479, 0.304479, 0.304482, 0.304479, 0.304481, 0.304482, 0.304481, 0.304482, 0.304481, 0.304481, 0.304483, 0.304487, 0.304488, 0.304486, 0.304485, 0.304483, 0.304487, 0.304483, 0.304483, 0.304489, 0.304486, 0.304485, 0.304484, 0.304487, 0.304486, 0.304487, 0.304495, 0.304485, 0.304487, 0.304492, 0.304494, 0.304495, 0.304489, 0.304489, 0.304492, 0.304485, 0.304490, 0.304491, 0.304497, 0.304498, 0.304497, 0.304497, 0.304489, 0.304497, 0.304491, 0.304495, 0.304497, 0.304491, 0.304493, 0.304489, 0.304493, 0.304502, 0.304498, 0.304492, 0.304495, 0.304492, 0.304486, 0.304507, 0.304485, 0.304482, 0.304496, 0.304494, 0.304493, 0.304499, 0.304496, 0.304496, 0.304517, 0.304497, 0.304499, 0.304496, 0.304497, 0.304496, 0.304500, 0.304490, 0.304498, 0.304496, 0.304495, 0.304495, 0.304494, 0.304509];
var hm30 = [0.321160, 0.321150, 0.321114, 0.321079, 0.321014, 0.320953, 0.320851, 0.320763, 0.320632, 0.320516, 0.320343, 0.320201, 0.319999, 0.319835, 0.319597, 0.319408, 0.319129, 0.318915, 0.318610, 0.318366, 0.318022, 0.317751, 0.317377, 0.317088, 0.316686, 0.316254, 0.315925, 0.315476, 0.315119, 0.314629, 0.314255, 0.313737, 0.313193, 0.312779, 0.312204, 0.311775, 0.311170, 0.310573, 0.310094, 0.309449, 0.308962, 0.308289, 0.307600, 0.307095, 0.306372, 0.305646, 0.305086, 0.304341, 0.303551, 0.302787, 0.302198, 0.301383, 0.300576, 0.299953, 0.299092, 0.298247, 0.297392, 0.296515, 0.295839, 0.294948, 0.294000, 0.293086, 0.292167, 0.291228, 0.290509, 0.289549, 0.288584, 0.287605, 0.286604, 0.285603, 0.284600, 0.283578, 0.282551, 0.281524, 0.280472, 0.279435, 0.278382, 0.277324, 0.276250, 0.275152];
var ha30 =  [0.274142, 0.274179, 0.274237, 0.274336, 0.274441, 0.274582, 0.274756, 0.274950, 0.275164, 0.275406, 0.275749, 0.276047, 0.276379, 0.276738, 0.277120, 0.277534, 0.277969, 0.278436, 0.278931, 0.279456, 0.280014, 0.280595, 0.281214, 0.281866, 0.282540, 0.283258, 0.284000, 0.284768, 0.285596, 0.286439, 0.287324, 0.288258, 0.289225, 0.289968, 0.290983, 0.292062, 0.293178, 0.294336, 0.295550, 0.296485, 0.297766, 0.299117, 0.300504, 0.301944, 0.303069, 0.304591, 0.306199, 0.307439, 0.309148, 0.310905, 0.312296, 0.314189, 0.315652, 0.317669, 0.319237, 0.321420, 0.323088, 0.325414, 0.327204, 0.329696, 0.331624, 0.334296, 0.336374, 0.338489, 0.341459, 0.343765, 0.346135, 0.348611, 0.352037, 0.354663, 0.357437, 0.360273, 0.363220, 0.366275, 0.369460, 0.372744, 0.376149, 0.379714, 0.383387, 0.387211];
var ct30 = [0.387669, 0.387631, 0.387518, 0.387322, 0.387048, 0.386702, 0.386267, 0.385772, 0.385216, 0.384583, 0.383885, 0.383115, 0.382381, 0.381443, 0.380435, 0.379353, 0.378206, 0.376986, 0.375699, 0.374352, 0.372930, 0.371457, 0.369918, 0.368313, 0.366662, 0.364636, 0.362892, 0.361137, 0.358964, 0.357110, 0.354950, 0.352915, 0.350481, 0.348450, 0.345961, 0.343683, 0.341270, 0.338661, 0.336130, 0.333306, 0.330658, 0.328280, 0.325495, 0.322681, 0.319371, 0.316850, 0.313631, 0.311021, 0.307819, 0.304406, 0.301474, 0.298334, 0.295094, 0.291659, 0.288210, 0.285266, 0.281826, 0.278398, 0.274973, 0.271567, 0.267812, 0.264458, 0.260957, 0.257149, 0.253836, 0.250086, 0.246472, 0.242668, 0.239022, 0.235410, 0.231554, 0.227868, 0.223952, 0.220235, 0.216708, 0.212958, 0.208849, 0.205221, 0.201281, 0.197703];
var st30 = [0.237439, 0.237564, 0.237773, 0.238062, 0.238431, 0.238886, 0.239426, 0.240056, 0.240774, 0.241586, 0.242490, 0.243495, 0.244601, 0.245821, 0.247142, 0.248584, 0.250144, 0.251855, 0.253692, 0.255168, 0.257264, 0.259534, 0.261980, 0.263932, 0.266731, 0.269733, 0.272158, 0.275603, 0.278365, 0.282329, 0.285516, 0.288907, 0.293785, 0.297710, 0.301941, 0.306818, 0.311286, 0.316501, 0.322808, 0.330988, 0.334811, 0.341987, 0.349834, 0.358000, 0.368927, 0.377047, 0.384764, 0.394449, 0.410229, 0.413422, 0.429608, 0.441889, 0.455500, 0.462867, 0.443157, 0.453607, 0.424685, 0.424392, 0.433920, 0.441279, 0.405254, 0.416390, 0.434195, 0.432311, 0.400062, 0.406862, 0.419588, 0.403546, 0.408939, 0.406416, 0.402229, 0.402549, 0.399340, 0.369761, 0.395979, 0.392594, 0.380418, 0.373600, 0.380551, 0.395687];
var ea30 = [0.362391, 0.362316, 0.362116, 0.361780, 0.361308, 0.360752, 0.360022, 0.359155, 0.358156, 0.358232, 0.357324, 0.356591, 0.358789, 0.356690, 0.355342, 0.359390, 0.358614, 0.360884, 0.355944, 0.354377, 0.356235, 0.356422, 0.356683, 0.352985, 0.354788, 0.356034, 0.354618, 0.354911, 0.356435, 0.355533, 0.357954, 0.356776, 0.355887, 0.356112, 0.358158, 0.359954, 0.358956, 0.356199, 0.357619, 0.358691, 0.353264, 0.356182, 0.355673, 0.355086, 0.354013, 0.355905, 0.355885, 0.353742, 0.355485, 0.356367, 0.352478, 0.355468, 0.354873, 0.355364, 0.359667, 0.353419, 0.355051, 0.355738, 0.356813, 0.354803, 0.355597, 0.361185, 0.355566, 0.357305, 0.357947, 0.359247, 0.357999, 0.357231, 0.356042, 0.358976, 0.357013, 0.358149, 0.359145, 0.360014, 0.360715, 0.361301, 0.361769, 0.362109, 0.362306, 0.362374];
var id30 = [ 0.149836, 0.152265, 0.152247, 0.151973, 0.151690, 0.150923, 0.151201, 0.152465, 0.153955, 0.153247, 0.152164, 0.154045, 0.155309, 0.154059, 0.154928, 0.155637, 0.157622, 0.156957, 0.158839, 0.158485, 0.159984, 0.161803, 0.164084, 0.163420, 0.164367, 0.167127, 0.167340, 0.169057, 0.171358, 0.172978, 0.176024, 0.177327, 0.178576, 0.181368, 0.184403, 0.186551, 0.189098, 0.192992, 0.194604, 0.198319, 0.202134, 0.203648, 0.208130, 0.211326, 0.216912, 0.221444, 0.225829, 0.232686, 0.237080, 0.243296, 0.250151, 0.258415, 0.266052, 0.273201, 0.283756, 0.294073, 0.309326, 0.321812, 0.334750, 0.350642, 0.364797, 0.385195, 0.407769, 0.429670, 0.460274, 0.491546, 0.525824, 0.574127, 0.625962, 0.685440, 0.760475, 0.882185, 1.001915, 1.180211, 1.461279, 1.870592, 2.860050, 5.403018, 4.495836, 5.424217];

var id31 = [0.167894, 0.167980, 0.168132, 0.168351, 0.168581, 0.168919, 0.169320, 0.169807, 0.170252, 0.170864, 0.171557, 0.172314, 0.173021, 0.173936, 0.174776, 0.175861, 0.176842, 0.178114, 0.179247, 0.180736, 0.182068, 0.183492, 0.185323, 0.186973, 0.188732, 0.190607, 0.192619, 0.194782, 0.197089, 0.199573, 0.202228, 0.204515, 0.207560, 0.210853, 0.213674, 0.216691, 0.220758, 0.224273, 0.228492, 0.233175, 0.237652, 0.244285, 0.247906, 0.255560, 0.259285, 0.265981, 0.270594, 0.278725, 0.288364, 0.296934, 0.305397, 0.313597, 0.323382, 0.332865, 0.347843, 0.363902, 0.377981, 0.393965, 0.406030, 0.425577, 0.444967, 0.469968, 0.494036, 0.526082, 0.559754, 0.596141, 0.647578, 0.699541, 0.767887, 0.844372, 0.926966, 1.053047, 1.219973, 1.468273, 1.779073, 2.334658, 3.753255, 5.964784, 4.501343, 6.027414];
var em31 = [0.263687, 0.263685, 0.263684, 0.263673, 0.263665, 0.263655, 0.263637, 0.263620, 0.263605, 0.263585, 0.263562, 0.263536, 0.263503, 0.263467, 0.263448, 0.263404, 0.263364, 0.263333, 0.263282, 0.263237, 0.263194, 0.263142, 0.263086, 0.263038, 0.262988, 0.262930, 0.262847, 0.262810, 0.262728, 0.262673, 0.262600, 0.262533, 0.262455, 0.262395, 0.262324, 0.262222, 0.262150, 0.262085, 0.261984, 0.261905, 0.261841, 0.261735, 0.261644, 0.261587, 0.261478, 0.261377, 0.261295, 0.261196, 0.261093, 0.260991, 0.261903, 0.261087, 0.260703, 0.260613, 0.260525, 0.261193, 0.261034, 0.260217, 0.260078, 0.259994, 0.259904, 0.260419, 0.260913, 0.260918, 0.259483, 0.262555, 0.260148, 0.260579, 0.259053, 0.259421, 0.259063, 0.260190, 0.260904, 0.258525, 0.259191, 0.260502, 0.258744, 0.258116, 0.258674, 0.260293];
var hm31 = [0.278134, 0.278125, 0.278089, 0.278055, 0.277990, 0.277931, 0.277829, 0.277739, 0.277606, 0.277491, 0.277321, 0.277180, 0.276980, 0.276814, 0.276576, 0.276389, 0.276111, 0.275902, 0.275598, 0.275357, 0.275021, 0.274750, 0.274378, 0.274092, 0.273695, 0.273271, 0.272944, 0.272498, 0.272150, 0.271667, 0.271296, 0.270784, 0.270256, 0.269842, 0.269281, 0.268856, 0.268264, 0.267687, 0.267213, 0.266581, 0.266102, 0.265461, 0.264778, 0.264283, 0.263807, 0.262880, 0.262327, 0.261614, 0.260855, 0.260188, 0.259545, 0.258758, 0.257972, 0.257377, 0.256539, 0.255732, 0.254903, 0.254071, 0.253414, 0.252567, 0.251669, 0.250786, 0.249914, 0.249413, 0.248332, 0.247420, 0.246517, 0.245814, 0.245304, 0.244098, 0.242744, 0.241781, 0.241651, 0.241363, 0.238867, 0.237893, 0.236914, 0.235918, 0.234915, 0.233910];
var ha31 = [0.237414, 0.237440, 0.237482, 0.237557, 0.237632, 0.237737, 0.237868, 0.238010, 0.238167, 0.238346, 0.238601, 0.238824, 0.239068, 0.239333, 0.239616, 0.239924, 0.240246, 0.240595, 0.240959, 0.241350, 0.241767, 0.242202, 0.242663, 0.243153, 0.243650, 0.244193, 0.244745, 0.245326, 0.245945, 0.246578, 0.247240, 0.247948, 0.248680, 0.249240, 0.250008, 0.250823, 0.251672, 0.252552, 0.253476, 0.254193, 0.255168, 0.256197, 0.257258, 0.258367, 0.259552, 0.260402, 0.262919, 0.263591, 0.264712, 0.266520, 0.266348, 0.267820, 0.269556, 0.271003, 0.274028, 0.276035, 0.276096, 0.279335, 0.280201, 0.280607, 0.282723, 0.284656, 0.286776, 0.288031, 0.290863, 0.291940, 0.295673, 0.295016, 0.298847, 0.299820, 0.302535, 0.308193, 0.307296, 0.311354, 0.313997, 0.315423, 0.320073, 0.321333, 0.324837, 0.327617];
var ct31 = [0.335734, 0.335699, 0.335599, 0.335429, 0.335190, 0.334890, 0.334515, 0.334088, 0.333608, 0.333060, 0.332455, 0.331788, 0.331144, 0.330328, 0.329454, 0.328531, 0.327524, 0.326468, 0.325351, 0.324183, 0.322968, 0.321672, 0.320340, 0.318955, 0.317523, 0.315757, 0.314277, 0.312752, 0.310875, 0.309267, 0.307373, 0.305614, 0.303529, 0.301768, 0.299608, 0.297613, 0.295545, 0.293290, 0.291067, 0.288653, 0.286329, 0.284301, 0.281890, 0.279454, 0.276585, 0.274369, 0.271614, 0.269319, 0.266577, 0.263627, 0.261084, 0.258334, 0.255559, 0.252582, 0.249594, 0.247045, 0.244068, 0.241099, 0.238133, 0.235185, 0.231902, 0.228996, 0.225999, 0.222696, 0.219828, 0.216582, 0.213416, 0.210158, 0.207004, 0.203874, 0.200499, 0.197340, 0.193949, 0.190694, 0.187678, 0.184400, 0.180874, 0.177725, 0.174291, 0.171191];
var st31 = [0.193867, 0.193964, 0.194128, 0.194353, 0.194643, 0.194999, 0.195421, 0.195915, 0.196477, 0.197113, 0.197821, 0.198609, 0.199477, 0.200432, 0.201469, 0.202600, 0.203823, 0.205167, 0.206609, 0.207768, 0.209416, 0.211201, 0.213121, 0.214658, 0.218195, 0.219218, 0.221130, 0.223839, 0.226012, 0.229138, 0.231646, 0.234321, 0.238169, 0.244301, 0.245587, 0.250119, 0.253242, 0.260177, 0.265534, 0.268025, 0.273031, 0.280674, 0.285564, 0.288763, 0.297142, 0.302250, 0.312887, 0.317798, 0.324923, 0.332681, 0.345683, 0.355421, 0.366225, 0.372075, 0.353797, 0.362924, 0.337976, 0.334421, 0.343623, 0.350737, 0.328787, 0.327364, 0.343760, 0.341902, 0.313045, 0.317930, 0.329453, 0.322066, 0.319870, 0.319907, 0.312557, 0.313610, 0.311957, 0.306270, 0.310384, 0.305129, 0.293061, 0.293167, 0.292279, 0.306796];
var ea31= [0.277942, 0.277891, 0.277761, 0.277542, 0.277234, 0.276872, 0.276396, 0.275832, 0.275182, 0.274444, 0.273687, 0.272973, 0.273882, 0.273735, 0.273363, 0.274831, 0.274403, 0.276425, 0.271575, 0.270356, 0.272048, 0.272993, 0.272509, 0.270791, 0.271600, 0.272516, 0.272620, 0.273101, 0.273301, 0.271113, 0.274012, 0.273741, 0.272485, 0.274519, 0.274552, 0.275308, 0.274697, 0.273077, 0.272814, 0.274743, 0.273203, 0.273041, 0.271938, 0.272384, 0.272963, 0.273100, 0.273428, 0.271362, 0.272619, 0.271927, 0.270747, 0.271829, 0.270927, 0.273358, 0.274968, 0.270102, 0.273022, 0.274470, 0.273515, 0.274319, 0.271323, 0.276816, 0.271143, 0.272543, 0.274253, 0.275282, 0.275720, 0.273781, 0.272946, 0.274573, 0.274436, 0.275175, 0.275820, 0.276389, 0.276842, 0.277227, 0.277530, 0.277754, 0.277882, 0.277927];

var bax = new Array(80);

{
  for(var i=0; i<80; i++) bax[i] = i/79.0;
}

var em30t = {y:em30, x:bax, name:'exp-map' };
var hm30t = {y:hm30, x:bax, name:'h-mean'  };
var ha30t = {y:ha30, x:bax, name:'h-angle' };
var ct30t = {y:ct30, x:bax, name:'Cayley'  };
var ea30t = {y:ea30, x:bax, name:'ZXZ' };
var st30t = {y:st30, x:bax, name:'ST'  };
var id30t = {y:id30, x:bax, name:'identity'  };

var basicByAngle30 = [em30t,hm30t,ha30t,ct30t,st30t,ea30t,id30t];


var em31t = {y:em31, x:bax, name:'exp-map' };
var hm31t = {y:hm31, x:bax, name:'h-mean'  };
var ha31t = {y:ha31, x:bax, name:'h-angle' };
var ct31t = {y:ct31, x:bax, name:'Cayley'  };
var ea31t = {y:ea31, x:bax, name:'ZXZ' };
var st31t = {y:st31, x:bax, name:'ST'  };
var id31t = {y:id31, x:bax, name:'identity'  };

var basicByAngle31 = [em31t,hm31t,ha31t,ct31t,st31t,ea31t,id31t];


// basic by angle values (32-bit)

var emidm = [0.215304, 0.215300, 0.215297, 0.215287, 0.215276, 0.215261, 0.215242, 0.215226, 0.215203, 0.215177, 0.215148, 0.215115, 0.215075, 0.215038, 0.215010, 0.214950, 0.214912, 0.214868, 0.214812, 0.214750, 0.214706, 0.214644, 0.214563, 0.214517, 0.214425, 0.214358, 0.214294, 0.214226, 0.214139, 0.214056, 0.213973, 0.213896, 0.213794, 0.213703, 0.213615, 0.213511, 0.213408, 0.213339, 0.213212, 0.213117, 0.213030, 0.212904, 0.212808, 0.212709, 0.214073, 0.212945, 0.212745, 0.212402, 0.212397, 0.211999, 0.211899, 0.212867, 0.212217, 0.212115, 0.211408, 0.212344, 0.211158, 0.211431, 0.212815, 0.212696, 0.212700, 0.211652, 0.212435, 0.210831, 0.211299, 0.211896, 0.211349, 0.211290, 0.211974, 0.212979, 0.210853, 0.211310, 0.212515, 0.213759, 0.212821, 0.211818, 0.211574, 0.212669, 0.213991, 0.212247];
var haidm = [0.193849, 0.193870, 0.193906, 0.193954, 0.194019, 0.194098, 0.194186, 0.194293, 0.194411, 0.194546, 0.194735, 0.194904, 0.195082, 0.195276, 0.195492, 0.195723, 0.195960, 0.196225, 0.196506, 0.196794, 0.197100, 0.197429, 0.197772, 0.198138, 0.198520, 0.198924, 0.199337, 0.199778, 0.200241, 0.200720, 0.201218, 0.201750, 0.202309, 0.202730, 0.204059, 0.203929, 0.204585, 0.205236, 0.206768, 0.206490, 0.207235, 0.208011, 0.208814, 0.209661, 0.210324, 0.212370, 0.212167, 0.214324, 0.215245, 0.215191, 0.218614, 0.219537, 0.219145, 0.219780, 0.222600, 0.222330, 0.225557, 0.226212, 0.227434, 0.229570, 0.232356, 0.232413, 0.233829, 0.234108, 0.235941, 0.239460, 0.238671, 0.240877, 0.243857, 0.247660, 0.250083, 0.250141, 0.252934, 0.255420, 0.254822, 0.259020, 0.259864, 0.262584, 0.264519, 0.269804];
var ctidm = [0.274130, 0.274103, 0.274015, 0.273877, 0.273682, 0.273433, 0.273132, 0.272787, 0.272393, 0.271945, 0.271449, 0.270905, 0.270367, 0.269704, 0.268988, 0.268248, 0.267414, 0.266550, 0.265632, 0.264684, 0.263701, 0.262633, 0.261545, 0.260413, 0.259245, 0.257818, 0.256608, 0.255366, 0.253831, 0.252519, 0.250948, 0.249521, 0.247831, 0.246392, 0.244640, 0.242978, 0.241322, 0.239470, 0.237634, 0.235679, 0.233768, 0.232125, 0.230159, 0.228171, 0.225878, 0.224003, 0.221782, 0.219879, 0.217658, 0.215249, 0.213172, 0.210909, 0.208664, 0.206236, 0.203798, 0.201721, 0.199282, 0.196860, 0.194435, 0.192028, 0.189323, 0.186952, 0.184527, 0.181839, 0.179496, 0.176833, 0.174240, 0.171595, 0.169020, 0.166461, 0.163679, 0.161120, 0.158359, 0.155686, 0.153234, 0.150547, 0.147677, 0.145113, 0.142313, 0.139761];
var hmidm = [0.227097, 0.227087, 0.227063, 0.227029, 0.226975, 0.226919, 0.226834, 0.226756, 0.226637, 0.226539, 0.226390, 0.226269, 0.226095, 0.225949, 0.225742, 0.225580, 0.225344, 0.225151, 0.224891, 0.224680, 0.224389, 0.224158, 0.223840, 0.223583, 0.223232, 0.222876, 0.222590, 0.222202, 0.221893, 0.221475, 0.221156, 0.220711, 0.220267, 0.219911, 0.219422, 0.219050, 0.218550, 0.218027, 0.217635, 0.217091, 0.216685, 0.216109, 0.215541, 0.215105, 0.214499, 0.213957, 0.213519, 0.213133, 0.212149, 0.211506, 0.211011, 0.210335, 0.211106, 0.209155, 0.209136, 0.207748, 0.207050, 0.206915, 0.205762, 0.205041, 0.204278, 0.205072, 0.203493, 0.203391, 0.202200, 0.200647, 0.201307, 0.200425, 0.199144, 0.197932, 0.198272, 0.197729, 0.195790, 0.196217, 0.193859, 0.195235, 0.193309, 0.192086, 0.192329, 0.191654];
var dwdm  = [0.137086, 0.137152, 0.137274, 0.137440, 0.137622, 0.137891, 0.138206, 0.138582, 0.138939, 0.139412, 0.139952, 0.140554, 0.141101, 0.141825, 0.142473, 0.143333, 0.144101, 0.145099, 0.145992, 0.147159, 0.148206, 0.149310, 0.150768, 0.152059, 0.153445, 0.155476, 0.156506, 0.158203, 0.160027, 0.161971, 0.164075, 0.165865, 0.168283, 0.170881, 0.173108, 0.175961, 0.178976, 0.181953, 0.186361, 0.188516, 0.192213, 0.196361, 0.200725, 0.205345, 0.210711, 0.215153, 0.222452, 0.226874, 0.232920, 0.240814, 0.248466, 0.253671, 0.261624, 0.272356, 0.282437, 0.292557, 0.306748, 0.320716, 0.333985, 0.350675, 0.363766, 0.385034, 0.406015, 0.429900, 0.459749, 0.485973, 0.525851, 0.570553, 0.626021, 0.684214, 0.751925, 0.882784, 0.996025, 1.158518, 1.408029, 1.870383, 2.786638, 5.450275, 4.500648, 5.388440];
var zxz = [ 0.196527, 0.196497, 0.196394, 0.196250, 0.196022, 0.195760, 0.195440, 0.195039, 0.194574, 0.194047, 0.193496, 0.192883, 0.193080, 0.191426, 0.191491, 0.192999, 0.190825, 0.192356, 0.190631, 0.188465, 0.189942, 0.189171, 0.191639, 0.187831, 0.188603, 0.190373, 0.189647, 0.189566, 0.187680, 0.189681, 0.188992, 0.190423, 0.190223, 0.190945, 0.191139, 0.190481, 0.192930, 0.192311, 0.189769, 0.192301, 0.192651, 0.189910, 0.190121, 0.187180, 0.188603, 0.184812, 0.187685, 0.192202, 0.192395, 0.189845, 0.189368, 0.189063, 0.185653, 0.192637, 0.190187, 0.190639, 0.190554, 0.192972, 0.191059, 0.190347, 0.188906, 0.188958, 0.188366, 0.190063, 0.193010, 0.191033, 0.192461, 0.192177, 0.192868, 0.193478, 0.194052, 0.194556, 0.195022, 0.195435, 0.195747, 0.196025, 0.196238, 0.196388, 0.196481, 0.196521];
var sot = [0.137089, 0.137166, 0.137296, 0.137474, 0.137703, 0.138024, 0.138368, 0.138765, 0.139219, 0.139727, 0.140298, 0.140929, 0.141623, 0.142384, 0.143224, 0.144126, 0.144968, 0.146033, 0.147171, 0.148243, 0.149553, 0.150966, 0.152298, 0.153724, 0.155449, 0.157081, 0.158836, 0.160704, 0.162689, 0.164848, 0.167139, 0.169241, 0.171892, 0.174289, 0.177344, 0.180136, 0.183134, 0.186367, 0.189847, 0.193606, 0.197685, 0.201363, 0.206147, 0.210458, 0.216161, 0.221345, 0.227014, 0.233243, 0.238692, 0.246173, 0.254532, 0.261940, 0.270156, 0.274604, 0.271745, 0.265417, 0.262512, 0.251168, 0.259639, 0.253097, 0.239100, 0.234625, 0.246083, 0.244219, 0.239328, 0.227156, 0.231840, 0.227503, 0.228393, 0.225156, 0.217266, 0.216785, 0.220910, 0.216061, 0.212842, 0.208187, 0.214151, 0.201619, 0.196043, 0.209971];

var baemm = {y:emidm, x:bax, name:'exp-map'  };
var bahmm = {y:hmidm, x:bax, name:'h-mean'   };
var baham = {y:haidm, x:bax, name:'h-angle'  };
var bactm = {y:ctidm, x:bax, name:'Cayley'   };
var badwm = {y:dwdm,  x:bax, name:'identity' };
var bazxz = {y:zxz,   x:bax, name:'ZXZ' };
var bastm = {y:sot,   x:bax, name:'ST'  };


var basicByAngle32 = [baemm,bahmm,baham,bactm,bastm,bazxz,badwm];

// density plot values (should be computing)
var plot0 = {
x:[2.04082e-8, 0.000306718, 0.000613415, 0.000920113, 0.00122681, 
0.00153351, 0.00184021, 0.0021469, 0.0024536, 0.0027603, 0.003067, 
0.00337369, 0.00368039, 0.00398709, 0.00429379, 0.00490718, 
0.00521388, 0.00552058, 0.00613397, 0.00644067, 0.00674737, 
0.00736076, 0.00766746, 0.00797416, 0.00858755, 0.00981434, 0.010121, 
0.0104277, 0.0110411, 0.0122679, 0.0125746, 0.0128813, 0.0134947, 
0.0147215, 0.0150282, 0.0153349, 0.0159483, 0.0171751, 0.0196287, 
0.0199612, 0.0202937, 0.0209586, 0.0222886, 0.0249486, 0.0252811, 
0.0256136, 0.0262786, 0.0276085, 0.0302685, 0.030601, 0.0309335, 
0.0315985, 0.0329285, 0.0355884, 0.0409084, 0.0412188, 0.0415293, 
0.0421502, 0.043392, 0.0458757, 0.0508431, 0.0511536, 0.051464, 
0.052085, 0.0533268, 0.0558105, 0.0607779, 0.0610823, 0.0613866, 
0.0619954, 0.0632129, 0.0656478, 0.0705178, 0.0708221, 0.0711265, 
0.0717352, 0.0729527, 0.0753877, 0.0802576, 0.0805878, 0.080918, 
0.0815783, 0.082899, 0.0855404, 0.0908231, 0.101388, 0.101697, 
0.102005, 0.102621, 0.103854, 0.106319, 0.111249, 0.121109, 0.142481, 
0.163463, 0.183035, 0.204257, 0.22407, 0.243493, 0.264567, 0.284231, 
0.305546, 0.326471, 0.345985, 0.367151, 0.386907, 0.408314, 0.429331, 
0.448938, 0.470196, 0.490044, 0.509502, 0.530611, 0.55031, 0.57166, 
0.59262, 0.61217, 0.633371, 0.653162, 0.672563, 0.693616, 0.713258, 
0.734551, 0.754434, 0.773927, 0.795071, 0.814805, 0.83619, 0.857186, 
0.876771, 0.898007, 0.917833, 0.93727, 0.958357, 0.978034, 0.978377, 
0.978721, 0.979407, 0.98078, 0.983526, 0.989017, 0.98936, 0.989704, 
0.99039, 0.991763, 0.994509, 0.994852, 0.995195, 0.995881, 0.997254, 
0.997597, 0.997941, 0.998627, 0.99897, 0.999314, 0.999657, 1.],
y:[1.5708, 1.5708, 1.5708, 1.57079, 1.57079, 1.57079, 1.57079, 
1.57079, 1.57078, 1.57078, 1.57078, 1.57077, 1.57077, 1.57077, 
1.57076, 1.57075, 1.57074, 1.57074, 1.57072, 1.57072, 1.57071, 
1.57069, 1.57068, 1.57067, 1.57065, 1.57061, 1.5706, 1.57059, 
1.57056, 1.5705, 1.57049, 1.57047, 1.57044, 1.57038, 1.57036, 
1.57034, 1.5703, 1.57022, 1.57005, 1.57002, 1.57, 1.56995, 1.56983, 
1.56959, 1.56956, 1.56953, 1.56946, 1.56932, 1.56902, 1.56898, 
1.56894, 1.56886, 1.5687, 1.56834, 1.56755, 1.56751, 1.56746, 
1.56735, 1.56715, 1.56672, 1.56579, 1.56573, 1.56567, 1.56554, 
1.56529, 1.56476, 1.56364, 1.56357, 1.5635, 1.56335, 1.56306, 
1.56245, 1.56117, 1.56109, 1.561, 1.56083, 1.56049, 1.5598, 1.55833, 
1.55823, 1.55812, 1.55792, 1.5575, 1.55664, 1.55484, 1.55092, 1.5508, 
1.55068, 1.55043, 1.54994, 1.54894, 1.54687, 1.54246, 1.53162, 
1.5193, 1.50632, 1.49064, 1.4745, 1.45729, 1.43709, 1.41682, 1.39332, 
1.36874, 1.34447, 1.31673, 1.28952, 1.25863, 1.22693, 1.19614, 
1.16148, 1.12795, 1.09402, 1.05605, 1.01957, 0.978929, 0.93796, 
0.89883, 0.855438, 0.814076, 0.772764, 0.727126, 0.683827, 0.636155, 
0.590996, 0.546162, 0.496954, 0.450532, 0.399738, 0.349432, 0.30216, 
0.250582, 0.202176, 0.154531, 0.102677, 0.0541875, 0.0533412, 
0.0524948, 0.050802, 0.0474163, 0.0406442, 0.0270978, 0.0262511, 
0.0254044, 0.0237109, 0.0203238, 0.0135494, 0.0127026, 0.0118558, 
0.0101621, 0.00677481, 0.00592797, 0.00508112, 0.00338744, 
0.00254059, 0.00169374, 0.000846897, 5.03551e-8],
mode: 'lines',
name: 'identity'

};

var plot1 = {
x:[2.04082e-8, 0.000306718, 0.000613415, 0.000920113, 0.00122681, 
0.00153351, 0.00184021, 0.0021469, 0.0024536, 0.0027603, 0.003067, 
0.00337369, 0.00368039, 0.00398709, 0.00429379, 0.00490718, 
0.00521388, 0.00552058, 0.00613397, 0.00644067, 0.00674737, 
0.00736076, 0.00766746, 0.00797416, 0.00858755, 0.00981434, 0.010121, 
0.0104277, 0.0110411, 0.0122679, 0.0125746, 0.0128813, 0.0134947, 
0.0147215, 0.0150282, 0.0153349, 0.0159483, 0.0171751, 0.0196287, 
0.0199612, 0.0202937, 0.0209586, 0.0222886, 0.0249486, 0.0252811, 
0.0256136, 0.0262786, 0.0276085, 0.0302685, 0.030601, 0.0309335, 
0.0315985, 0.0329285, 0.0355884, 0.0409084, 0.0412188, 0.0415293, 
0.0421502, 0.043392, 0.0458757, 0.0508431, 0.0511536, 0.051464, 
0.052085, 0.0533268, 0.0558105, 0.0607779, 0.0610823, 0.0613866, 
0.0619954, 0.0632129, 0.0656478, 0.0705178, 0.0708221, 0.0711265, 
0.0717352, 0.0729527, 0.0753877, 0.0802576, 0.0805878, 0.080918, 
0.0815783, 0.082899, 0.0855404, 0.0908231, 0.101388, 0.101697, 
0.102005, 0.102621, 0.103854, 0.106319, 0.111249, 0.121109, 0.142481, 
0.163463, 0.183035, 0.204257, 0.22407, 0.243493, 0.264567, 0.284231, 
0.305546, 0.326471, 0.345985, 0.367151, 0.386907, 0.408314, 0.429331, 
0.448938, 0.470196, 0.490044, 0.509502, 0.530611, 0.55031, 0.57166, 
0.59262, 0.61217, 0.633371, 0.653162, 0.672563, 0.693616, 0.713258, 
0.734551, 0.754434, 0.773927, 0.795071, 0.814805, 0.83619, 0.857186, 
0.876771, 0.898007, 0.917833, 0.93727, 0.958357, 0.978034, 0.978377, 
0.978721, 0.979407, 0.98078, 0.983526, 0.989017, 0.98936, 0.989704, 
0.99039, 0.991763, 0.994509, 0.994852, 0.995195, 0.995881, 0.997254, 
0.997597, 0.997941, 0.998627, 0.99897, 0.999314, 0.999657, 1.],
y:[1.11072, 1.11072, 1.11072, 1.11072, 1.11072, 1.11072, 1.11072, 
1.11072, 1.11072, 1.11072, 1.11072, 1.11072, 1.11072, 1.11072, 
1.11071, 1.11071, 1.11071, 1.11071, 1.11071, 1.11071, 1.11071, 
1.1107, 1.1107, 1.1107, 1.1107, 1.11069, 1.11069, 1.11068, 1.11068, 
1.11067, 1.11067, 1.11066, 1.11066, 1.11065, 1.11064, 1.11064, 
1.11063, 1.11062, 1.11059, 1.11058, 1.11058, 1.11057, 1.11055, 
1.11051, 1.1105, 1.1105, 1.11048, 1.11046, 1.11041, 1.1104, 1.11039, 
1.11038, 1.11035, 1.11029, 1.11015, 1.11014, 1.11013, 1.11011, 
1.11008, 1.11, 1.10984, 1.10982, 1.10981, 1.10979, 1.10975, 1.10965, 
1.10946, 1.10944, 1.10943, 1.1094, 1.10935, 1.10924, 1.10902, 1.109, 
1.10899, 1.10896, 1.1089, 1.10877, 1.10851, 1.1085, 1.10848, 1.10844, 
1.10837, 1.10822, 1.1079, 1.1072, 1.10718, 1.10716, 1.10712, 1.10703, 
1.10685, 1.10648, 1.1057, 1.10377, 1.10158, 1.09926, 1.09646, 
1.09357, 1.09047, 1.08683, 1.08316, 1.07889, 1.07441, 1.06996, 
1.06486, 1.05983, 1.05409, 1.04817, 1.04239, 1.03584, 1.02946, 
1.02297, 1.01566, 1.00858, 1.00064, 0.992566, 0.984794, 0.976105, 
0.967748, 0.95933, 0.949943, 0.940951, 0.93095, 0.921376, 0.911772, 
0.901112, 0.89094, 0.879674, 0.868373, 0.857618, 0.845727, 0.834413, 
0.823125, 0.810661, 0.79883, 0.798622, 0.798414, 0.797998, 0.797164, 
0.795494, 0.792144, 0.791934, 0.791724, 0.791304, 0.790463, 0.788778, 
0.788567, 0.788357, 0.787935, 0.78709, 0.786879, 0.786667, 0.786245, 
0.786033, 0.785821, 0.78561, 0.785398],
mode: 'lines',
name: 'half angle'
};

var plot2 = {
x:[2.04082e-8, 0.000306718, 0.000613415, 0.000920113, 0.00122681, 
0.00153351, 0.00184021, 0.0021469, 0.0024536, 0.0027603, 0.003067, 
0.00337369, 0.00368039, 0.00398709, 0.00429379, 0.00490718, 
0.00521388, 0.00552058, 0.00613397, 0.00644067, 0.00674737, 
0.00736076, 0.00766746, 0.00797416, 0.00858755, 0.00981434, 0.010121, 
0.0104277, 0.0110411, 0.0122679, 0.0125746, 0.0128813, 0.0134947, 
0.0147215, 0.0150282, 0.0153349, 0.0159483, 0.0171751, 0.0196287, 
0.0199612, 0.0202937, 0.0209586, 0.0222886, 0.0249486, 0.0252811, 
0.0256136, 0.0262786, 0.0276085, 0.0302685, 0.030601, 0.0309335, 
0.0315985, 0.0329285, 0.0355884, 0.0409084, 0.0412188, 0.0415293, 
0.0421502, 0.043392, 0.0458757, 0.0508431, 0.0511536, 0.051464, 
0.052085, 0.0533268, 0.0558105, 0.0607779, 0.0610823, 0.0613866, 
0.0619954, 0.0632129, 0.0656478, 0.0705178, 0.0708221, 0.0711265, 
0.0717352, 0.0729527, 0.0753877, 0.0802576, 0.0805878, 0.080918, 
0.0815783, 0.082899, 0.0855404, 0.0908231, 0.101388, 0.101697, 
0.102005, 0.102621, 0.103854, 0.106319, 0.111249, 0.121109, 0.142481, 
0.163463, 0.183035, 0.204257, 0.22407, 0.243493, 0.264567, 0.284231, 
0.305546, 0.326471, 0.345985, 0.367151, 0.386907, 0.408314, 0.429331, 
0.448938, 0.470196, 0.490044, 0.509502, 0.530611, 0.55031, 0.57166, 
0.59262, 0.61217, 0.633371, 0.653162, 0.672563, 0.693616, 0.713258, 
0.734551, 0.754434, 0.773927, 0.795071, 0.814805, 0.83619, 0.857186, 
0.876771, 0.898007, 0.917833, 0.93727, 0.958357, 0.978034, 0.978377, 
0.978721, 0.979407, 0.98078, 0.983526, 0.989017, 0.98936, 0.989704, 
0.99039, 0.991763, 0.994509, 0.994852, 0.995195, 0.995881, 0.997254, 
0.997597, 0.997941, 0.998627, 0.99897, 0.999314, 0.999657, 1.],
y:[0.785398, 0.785398, 0.785398, 0.785399, 0.785399, 0.785399, 
0.7854, 0.7854, 0.785401, 0.785402, 0.785403, 0.785404, 0.785405, 
0.785406, 0.785407, 0.78541, 0.785411, 0.785413, 0.785416, 0.785418, 
0.78542, 0.785424, 0.785427, 0.785429, 0.785434, 0.785445, 0.785448, 
0.785451, 0.785457, 0.785471, 0.785475, 0.785479, 0.785486, 0.785503, 
0.785508, 0.785512, 0.785521, 0.785541, 0.785585, 0.785591, 0.785598, 
0.785611, 0.785639, 0.7857, 0.785708, 0.785716, 0.785733, 0.785768, 
0.785842, 0.785852, 0.785862, 0.785882, 0.785924, 0.786012, 0.786209, 
0.786222, 0.786234, 0.78626, 0.786311, 0.786419, 0.786652, 0.786667, 
0.786683, 0.786714, 0.786777, 0.786909, 0.787191, 0.787209, 0.787227, 
0.787263, 0.787337, 0.78749, 0.787812, 0.787833, 0.787854, 0.787897, 
0.787982, 0.788158, 0.788527, 0.788553, 0.788579, 0.788631, 0.788737, 
0.788954, 0.789408, 0.790399, 0.79043, 0.790461, 0.790522, 0.790647, 
0.7909, 0.791425, 0.792547, 0.795316, 0.798487, 0.801855, 0.805963, 
0.810233, 0.814837, 0.82031, 0.825875, 0.832422, 0.839385, 0.846372, 
0.854504, 0.862632, 0.872048, 0.881931, 0.891744, 0.903056, 0.914275, 
0.925918, 0.939302, 0.95253, 0.967712, 0.983516, 0.999099, 1.01697, 
1.03461, 1.05284, 1.07375, 1.09437, 1.11801, 1.14137, 1.16554, 
1.19328, 1.22068, 1.25215, 1.28495, 1.31738, 1.35469, 1.39168, 
1.43011, 1.47442, 1.51842, 1.51921, 1.52, 1.52159, 1.52477, 1.53118, 
1.54416, 1.54498, 1.5458, 1.54744, 1.55073, 1.55736, 1.5582, 1.55903, 
1.5607, 1.56405, 1.56489, 1.56573, 1.56742, 1.56826, 1.5691, 1.56995, 
1.5708],
mode: 'lines',
name: 'Cayley'
};

var plot3 = { x:[2.04082e-8, 1.], y:[1., 1.], mode: 'lines', name: 'exp-map' };

var plot5 = {
x:[2.04082e-8, 0.000306718, 0.000613415, 0.000920113, 0.00122681, 
0.00153351, 0.00184021, 0.0021469, 0.0024536, 0.0027603, 0.003067, 
0.00337369, 0.00368039, 0.00398709, 0.00429379, 0.00490718, 
0.00521388, 0.00552058, 0.00613397, 0.00644067, 0.00674737, 
0.00736076, 0.00766746, 0.00797416, 0.00858755, 0.00981434, 0.010121, 
0.0104277, 0.0110411, 0.0122679, 0.0125746, 0.0128813, 0.0134947, 
0.0147215, 0.0150282, 0.0153349, 0.0159483, 0.0171751, 0.0196287, 
0.0199612, 0.0202937, 0.0209586, 0.0222886, 0.0249486, 0.0252811, 
0.0256136, 0.0262786, 0.0276085, 0.0302685, 0.030601, 0.0309335, 
0.0315985, 0.0329285, 0.0355884, 0.0409084, 0.0412188, 0.0415293, 
0.0421502, 0.043392, 0.0458757, 0.0508431, 0.0511536, 0.051464, 
0.052085, 0.0533268, 0.0558105, 0.0607779, 0.0610823, 0.0613866, 
0.0619954, 0.0632129, 0.0656478, 0.0705178, 0.0708221, 0.0711265, 
0.0717352, 0.0729527, 0.0753877, 0.0802576, 0.0805878, 0.080918, 
0.0815783, 0.082899, 0.0855404, 0.0908231, 0.101388, 0.101697, 
0.102005, 0.102621, 0.103854, 0.106319, 0.111249, 0.121109, 0.142481, 
0.163463, 0.183035, 0.204257, 0.22407, 0.243493, 0.264567, 0.284231, 
0.305546, 0.326471, 0.345985, 0.367151, 0.386907, 0.408314, 0.429331, 
0.448938, 0.470196, 0.490044, 0.509502, 0.530611, 0.55031, 0.57166, 
0.59262, 0.61217, 0.633371, 0.653162, 0.672563, 0.693616, 0.713258, 
0.734551, 0.754434, 0.773927, 0.795071, 0.814805, 0.83619, 0.857186, 
0.876771, 0.898007, 0.917833, 0.93727, 0.958357, 0.978034, 0.978377, 
0.978721, 0.979407, 0.98078, 0.983526, 0.989017, 0.98936, 0.989704, 
0.99039, 0.991763, 0.994509, 0.994852, 0.995195, 0.995881, 0.997254, 
0.997597, 0.997941, 0.998627, 0.99897, 0.999314, 0.999657, 1.],
y:[0.948059, 0.948059, 0.94806, 0.94806, 0.94806, 0.94806, 0.94806, 
0.94806, 0.94806, 0.948061, 0.948061, 0.948061, 0.948061, 0.948062, 
0.948062, 0.948063, 0.948063, 0.948064, 0.948065, 0.948066, 0.948066, 
0.948067, 0.948068, 0.948069, 0.94807, 0.948074, 0.948074, 0.948075, 
0.948077, 0.948081, 0.948083, 0.948084, 0.948086, 0.948091, 0.948092, 
0.948094, 0.948097, 0.948103, 0.948116, 0.948118, 0.94812, 0.948124, 
0.948132, 0.94815, 0.948153, 0.948155, 0.94816, 0.948171, 0.948193, 
0.948196, 0.948199, 0.948205, 0.948218, 0.948245, 0.948304, 0.948308, 
0.948312, 0.948319, 0.948335, 0.948367, 0.948437, 0.948442, 0.948447, 
0.948456, 0.948475, 0.948515, 0.9486, 0.948605, 0.948611, 0.948622, 
0.948644, 0.94869, 0.948787, 0.948793, 0.948799, 0.948812, 0.948838, 
0.948891, 0.949002, 0.94901, 0.949017, 0.949033, 0.949065, 0.94913, 
0.949266, 0.949564, 0.949573, 0.949582, 0.949601, 0.949638, 0.949714, 
0.949871, 0.950207, 0.951034, 0.951977, 0.952974, 0.954185, 0.955438, 
0.956781, 0.958367, 0.95997, 0.961841, 0.963815, 0.965778, 0.968044, 
0.970287, 0.972858, 0.975527, 0.978147, 0.981132, 0.984054, 0.987049, 
0.990444, 0.993752, 0.99749, 1.00132, 1.00503, 1.00922, 1.01327, 
1.01739, 1.02203, 1.02651, 1.03154, 1.0364, 1.04132, 1.04684, 
1.05216, 1.05811, 1.06415, 1.06997, 1.07647, 1.08273, 1.08905, 
1.09612, 1.10291, 1.10303, 1.10315, 1.10339, 1.10387, 1.10484, 
1.10678, 1.10691, 1.10703, 1.10727, 1.10776, 1.10874, 1.10887, 
1.10899, 1.10924, 1.10973, 1.10985, 1.10998, 1.11023, 1.11035, 
1.11047, 1.1106, 1.11072],
mode: 'lines',
name: 'harmonic mean'
};

var data = [plot3,plot5,plot1,plot2,plot0];

var logLayout = {
  title:  'max error by bit allocation',
  yaxis:  { type: 'log', nticks:20 },
  height: 500,
  width:  800
};

Plotly.newPlot('fig1',  basic, logLayout, {displaylogo: false, autosizable: true});

var byAngle30 = {
  title:  'error by angle (30-bit)',
  yaxis: { range: [0.13, 0.49] },
  xaxis: { nticks: 20 },
  height: 500,
  width:  800
};

Plotly.newPlot('fig2a',  basicByAngle30, byAngle30, {displaylogo: false, autosizable: true});

var byAngle31 = {
  title:  'error by angle (31-bit)',
  yaxis: { range: [0.13, 0.4] },
  xaxis: { nticks: 20 },
  height: 500,
  width:  800
};

Plotly.newPlot('fig2b',  basicByAngle31, byAngle31, {displaylogo: false, autosizable: true});


var byAngle32 = {
  title:  'error by angle (32-bit)',
  yaxis: { range: [0.13, 0.28] },
  xaxis: { nticks: 20 },
  height: 500,
  width:  800
};

Plotly.newPlot('fig2c', basicByAngle32, byAngle32, {displaylogo: false, autosizable: true});

var layout = {
  title:  'density function',
  xaxis: { nticks: 10 },
  yaxis: { nticks: 20 },
  height: 500,
  width:  800
};

Plotly.newPlot('fig3', data, layout, {displaylogo: false, autosizable: true});

// error about x and diag

var emAboutX = [0.304465, 0.304452, 0.304413, 0.304340, 0.304252, 0.304142, 0.303982, 0.303824, 0.303607, 0.303399, 0.303167, 0.302872, 0.302588, 0.302232, 0.301905, 0.301550, 0.301116, 0.300713, 0.300224, 0.299784, 0.299312, 0.298743, 0.298231, 0.297606, 0.297052, 0.296466, 0.295768, 0.295151, 0.294398, 0.293733, 0.293054, 0.292234, 0.291499, 0.290636, 0.289863, 0.289074, 0.288138, 0.287314, 0.286337, 0.285482, 0.284595, 0.283565, 0.282654, 0.281554, 0.280615, 0.279657, 0.278516, 0.277520, 0.276345, 0.275322, 0.274278, 0.273068, 0.271996, 0.270740, 0.269654, 0.268540, 0.267278, 0.266127, 0.264809, 0.263684, 0.262512, 0.261165, 0.259985, 0.258615, 0.257422, 0.256218, 0.254829, 0.253612, 0.252205, 0.250979, 0.249757, 0.248330, 0.247110, 0.245660, 0.244425, 0.243181, 0.241745, 0.240493, 0.239058, 0.237798];
var haAboutX = [0.274118, 0.274113, 0.274098, 0.274077, 0.274049, 0.274008, 0.273960, 0.273907, 0.273843, 0.273772, 0.273692, 0.273591, 0.273492, 0.273387, 0.273276, 0.273151, 0.273029, 0.272894, 0.272751, 0.272604, 0.272446, 0.272283, 0.272115, 0.271939, 0.271760, 0.271603, 0.271414, 0.271216, 0.271025, 0.270817, 0.270611, 0.270429, 0.270212, 0.269998, 0.269784, 0.269592, 0.269373, 0.269161, 0.268978, 0.268756, 0.268541, 0.268360, 0.268142, 0.267967, 0.267770, 0.267606, 0.267437, 0.267255, 0.267112, 0.266955, 0.266817, 0.266713, 0.266603, 0.266501, 0.266404, 0.266343, 0.266305, 0.266269, 0.266267, 0.266304, 0.266346, 0.266432, 0.266519, 0.266654, 0.266828, 0.267040, 0.267239, 0.267516, 0.267790, 0.268171, 0.268523, 0.268972, 0.269422, 0.269899, 0.270552, 0.271144, 0.271792, 0.272503, 0.273291, 0.274131];
var hmAboutX = [0.321146, 0.321124, 0.321064, 0.320969, 0.320841, 0.320677, 0.320479, 0.320244, 0.319973, 0.319673, 0.319332, 0.318962, 0.318557, 0.318112, 0.317557, 0.317042, 0.316494, 0.315916, 0.315300, 0.314657, 0.313981, 0.313275, 0.312407, 0.311629, 0.310822, 0.309984, 0.309115, 0.308218, 0.307288, 0.306174, 0.305183, 0.304175, 0.303120, 0.302002, 0.300770, 0.299650, 0.298502, 0.297129, 0.295919, 0.294696, 0.293448, 0.291964, 0.290658, 0.289340, 0.287774, 0.286409, 0.285035, 0.283391, 0.281969, 0.280284, 0.278834, 0.277107, 0.275612, 0.273849, 0.272320, 0.270522, 0.268973, 0.267140, 0.265563, 0.263697, 0.262094, 0.260218, 0.258316, 0.256677, 0.254751, 0.252823, 0.250896, 0.249212, 0.247270, 0.245308, 0.243347, 0.241378, 0.239394, 0.237705, 0.235719, 0.233731, 0.231759, 0.229775, 0.227793, 0.225807];
var ctAboutX = [0.387657, 0.387607, 0.387486, 0.387288, 0.387018, 0.386679, 0.386263, 0.385776, 0.385217, 0.384585, 0.383884, 0.383114, 0.382275, 0.381365, 0.380391, 0.379354, 0.378020, 0.376835, 0.375596, 0.374292, 0.372929, 0.371215, 0.369728, 0.368185, 0.366587, 0.364606, 0.362892, 0.361139, 0.358966, 0.357108, 0.354821, 0.352874, 0.350481, 0.348447, 0.345964, 0.343426, 0.341278, 0.338661, 0.335999, 0.333306, 0.330582, 0.328278, 0.325492, 0.322679, 0.319371, 0.316505, 0.313627, 0.310733, 0.307816, 0.304407, 0.301474, 0.298042, 0.295092, 0.291659, 0.288214, 0.285269, 0.281824, 0.278400, 0.274975, 0.271567, 0.267693, 0.264317, 0.260958, 0.257150, 0.253836, 0.250080, 0.246357, 0.242674, 0.239025, 0.235408, 0.231392, 0.227864, 0.223951, 0.220091, 0.216708, 0.212544, 0.208846, 0.205223, 0.201259, 0.197356];
var stAboutX = [0.137068, 0.137093, 0.137137, 0.137201, 0.137279, 0.137382, 0.137495, 0.137634, 0.137790, 0.137967, 0.138159, 0.138378, 0.138602, 0.138866, 0.139158, 0.139446, 0.139787, 0.140139, 0.140508, 0.140941, 0.141379, 0.141852, 0.142316, 0.142864, 0.143452, 0.144037, 0.144721, 0.145404, 0.146132, 0.146927, 0.147786, 0.148631, 0.149629, 0.150618, 0.151686, 0.152846, 0.153991, 0.155362, 0.156707, 0.158189, 0.158189, 0.156710, 0.155358, 0.153991, 0.152846, 0.151683, 0.150624, 0.149626, 0.148631, 0.147786, 0.146927, 0.146132, 0.145404, 0.144726, 0.144037, 0.143454, 0.142862, 0.142314, 0.141850, 0.141379, 0.140941, 0.140508, 0.140138, 0.139787, 0.139446, 0.139157, 0.138867, 0.138603, 0.138380, 0.138159, 0.137967, 0.137790, 0.137634, 0.137495, 0.137380, 0.137278, 0.137197, 0.137139, 0.137094, 0.137067];

var emAboutD = [0.304480, 0.304479, 0.304482, 0.304481, 0.304482, 0.304477, 0.304480, 0.304481, 0.304482, 0.304482, 0.304483, 0.304486, 0.304487, 0.304484, 0.304486, 0.304485, 0.304485, 0.304483, 0.304479, 0.304491, 0.304486, 0.304491, 0.304491, 0.304487, 0.304487, 0.304490, 0.304495, 0.304489, 0.304486, 0.304499, 0.304492, 0.304499, 0.304485, 0.304485, 0.304494, 0.304491, 0.304506, 0.304500, 0.304497, 0.304498, 0.304506, 0.304503, 0.304490, 0.304492, 0.304488, 0.304503, 0.304500, 0.304509, 0.304494, 0.304497, 0.304496, 0.304501, 0.304492, 0.304495, 0.304495, 0.304492, 0.304498, 0.304500, 0.304497, 0.304489, 0.304502, 0.304491, 0.304485, 0.304495, 0.304503, 0.304504, 0.304517, 0.304495, 0.304501, 0.304500, 0.304494, 0.304502, 0.304484, 0.304511, 0.304496, 0.304509, 0.304496, 0.304494, 0.304486, 0.304508];
var haAboutD = [0.274142, 0.274181, 0.274246, 0.274334, 0.274451, 0.274593, 0.274755, 0.274949, 0.275164, 0.275409, 0.275748, 0.276052, 0.276379, 0.276735, 0.277120, 0.277534, 0.277965, 0.278436, 0.278938, 0.279459, 0.280014, 0.280595, 0.281211, 0.281863, 0.282540, 0.283258, 0.284000, 0.284772, 0.285592, 0.286440, 0.287320, 0.288250, 0.289225, 0.289968, 0.290992, 0.292067, 0.293191, 0.294336, 0.295564, 0.296490, 0.297776, 0.299117, 0.300499, 0.301940, 0.303064, 0.304591, 0.306199, 0.307439, 0.309145, 0.310909, 0.312296, 0.314189, 0.315646, 0.317672, 0.319246, 0.321414, 0.323087, 0.325414, 0.327200, 0.329696, 0.331630, 0.334299, 0.336374, 0.338489, 0.341459, 0.343778, 0.346135, 0.348585, 0.352036, 0.354679, 0.357432, 0.360271, 0.363218, 0.366278, 0.369444, 0.372749, 0.376137, 0.379706, 0.383397, 0.387211];
var hmAboutD = [0.321158, 0.321146, 0.321118, 0.321079, 0.321015, 0.320952, 0.320851, 0.320766, 0.320631, 0.320517, 0.320345, 0.320200, 0.320000, 0.319835, 0.319599, 0.319406, 0.319135, 0.318913, 0.318607, 0.318363, 0.318025, 0.317756, 0.317382, 0.317088, 0.316686, 0.316257, 0.315928, 0.315476, 0.315111, 0.314623, 0.314251, 0.313734, 0.313197, 0.312782, 0.312213, 0.311775, 0.311188, 0.310568, 0.310094, 0.309459, 0.308976, 0.308289, 0.307609, 0.307095, 0.306377, 0.305646, 0.305086, 0.304341, 0.303554, 0.302788, 0.302194, 0.301377, 0.300567, 0.299947, 0.299097, 0.298247, 0.297398, 0.296530, 0.295837, 0.294944, 0.294012, 0.293092, 0.292167, 0.291221, 0.290516, 0.289556, 0.288574, 0.287605, 0.286603, 0.285621, 0.284613, 0.283581, 0.282553, 0.281514, 0.280486, 0.279435, 0.278381, 0.277327, 0.276249, 0.275152];
var ctAboutD = [0.387670, 0.387630, 0.387517, 0.387324, 0.387049, 0.386701, 0.386271, 0.385763, 0.385174, 0.384508, 0.383779, 0.382962, 0.382379, 0.381444, 0.380433, 0.379355, 0.378208, 0.376989, 0.375697, 0.374352, 0.372929, 0.371457, 0.369918, 0.368316, 0.366668, 0.364370, 0.362576, 0.360752, 0.358858, 0.356930, 0.354946, 0.352911, 0.350163, 0.348026, 0.345882, 0.343683, 0.340691, 0.338421, 0.336130, 0.333013, 0.330658, 0.328257, 0.325049, 0.322612, 0.319329, 0.316852, 0.313531, 0.311024, 0.307660, 0.304288, 0.300882, 0.298337, 0.294947, 0.291530, 0.288134, 0.284724, 0.281319, 0.277917, 0.274544, 0.271173, 0.267807, 0.264457, 0.260321, 0.257019, 0.253750, 0.249679, 0.246472, 0.242474, 0.238529, 0.235405, 0.231537, 0.227711, 0.223951, 0.220232, 0.216572, 0.212958, 0.208695, 0.205197, 0.201089, 0.197712];
var stAboutD = [0.137090, 0.137166, 0.137296, 0.137472, 0.137703, 0.138024, 0.138368, 0.138767, 0.139217, 0.139725, 0.140299, 0.140929, 0.141625, 0.142385, 0.143224, 0.144126, 0.144981, 0.146022, 0.147169, 0.148245, 0.149555, 0.150966, 0.152292, 0.153721, 0.155455, 0.157086, 0.158836, 0.160701, 0.162692, 0.164848, 0.167143, 0.169241, 0.171888, 0.174294, 0.177344, 0.180132, 0.183134, 0.186367, 0.189852, 0.193606, 0.197685, 0.201372, 0.206142, 0.210468, 0.216155, 0.221356, 0.227025, 0.233249, 0.238697, 0.246167, 0.254526, 0.261940, 0.270162, 0.274610, 0.271746, 0.265416, 0.262512, 0.251168, 0.259638, 0.253097, 0.239100, 0.234315, 0.246083, 0.244217, 0.239326, 0.221259, 0.231839, 0.213508, 0.223014, 0.223641, 0.215185, 0.216783, 0.220910, 0.216062, 0.210398, 0.188360, 0.214148, 0.117003, 0.195770, 0.209968];

var pemax = {y:emAboutX, x:bax, name:'exp (X)'      };
var phmax = {y:hmAboutX, x:bax, name:'h-mean (X)'   };
var phaax = {y:haAboutX, x:bax, name:'h-angle (X)'  };
var pctax = {y:ctAboutX, x:bax, name:'Cayley (X)'   };
var pemad = {y:emAboutD, x:bax, name:'exp (D)'      };
var phmad = {y:hmAboutD, x:bax, name:'h-mean (D)'   };
var phaad = {y:haAboutD, x:bax, name:'h-angle (D)'  };
var pctad = {y:ctAboutD, x:bax, name:'Cayley (D)'   };

var pstax = {y:stAboutX, x:bax, name:'ST (X)'       };
var pstad = {y:stAboutD, x:bax, name:'ST (D)'       };
var data4 = [pemax,pemad,phmax,phmad,phaax,phaad,pctax,pctad];
var data4a= [pstax,pstad];

var layout4 = {
  xaxis: { nticks: 10 },
  yaxis: { nticks: 20 },
  height: 500,
  width:  800
};

Plotly.newPlot('fig4', data4,  layout4, {displaylogo: false, autosizable: true});
Plotly.newPlot('fig4a',data4a, layout4, {displaylogo: false, autosizable: true});

var em4g  = [19.485561, 18.278492, 17.278898, 16.525227, 16.052017, 16.031744, 
16.485825, 17.222292, 18.206921, 19.402412, 19.402412, 18.171862, 
17.481508, 19.142673, 19.398912, 17.972298, 18.764435, 19.485590, 
18.060467, 19.156797, 19.156792, 18.718489, 19.236021, 18.461016, 
19.228704, 18.491144, 17.113945, 18.645031, 19.163172, 19.239056, 
19.245522, 18.921930, 18.793938, 19.107910, 19.485584, 18.829802, 
18.930882, 19.167120, 18.236359, 18.224993, 18.900339, 19.305136, 
18.792015, 19.064238, 18.568289, 18.872433, 19.265766, 19.165943, 
18.988476, 19.095867, 18.900055, 19.485600, 19.399010, 19.163515, 
18.953051, 18.080099, 18.330383, 18.748322, 19.311974, 19.001995, 
19.070707, 18.885759, 18.315365, 19.265739, 19.187857, 19.107117, 
18.772186, 18.856693, 18.850981, 19.485592, 19.156075, 18.675827, 
18.085863, 18.790201, 18.620625, 19.213509, 19.182102, 18.804325, 
18.858543, 17.664169];
var em4x  = [9.485561, 18.278492, 17.278898, 16.525227, 16.052017, 16.031744,
16.485825, 17.222292, 18.206921, 19.402412, 19.402412, 18.171862,
17.147591, 16.368420, 15.870484, 15.809863, 16.250666, 16.978764,
17.959229, 19.156797, 19.156792, 17.892443, 16.833317, 16.020193,
15.491857, 15.391381, 15.825315, 16.554497, 17.542156, 18.758980,
18.758968, 17.450306, 16.346151, 15.490311, 14.925557, 14.786007,
15.220286, 15.961143, 16.968451, 18.224993, 18.224987, 16.861418,
15.701582, 14.793492, 14.185558, 14.007900, 14.450943, 15.215566,
16.256453, 17.576416, 17.576406, 16.147194, 14.920282, 13.949172,
13.290062, 13.075301, 13.537169, 14.339736, 15.429924, 16.839912,
16.839901, 15.334207, 14.027898, 12.981305, 12.261127, 12.010109,
12.503171, 13.360551, 14.517840, 15.909737, 16.046612, 14.453884,
13.054920, 11.918158, 11.124271, 10.837412, 11.377288, 12.309803,
13.554158, 15.033106];
var em4xy = [19.485558, 17.696201, 16.021498, 14.502484, 13.192813, 12.160262,
11.479805, 11.397042, 12.003538, 12.975765, 14.238948, 15.723171,
17.371866, 19.142529, 19.403055, 17.843462, 16.126120, 14.553649,
13.177994, 12.066678, 11.297975, 11.045640, 11.590019, 12.519798,
13.757040, 15.226999, 16.868933, 18.637438, 19.165201, 17.833712,
16.058428, 14.415358, 12.954886, 11.745341, 10.870801, 10.435947,
10.928051, 11.833563, 13.066803, 14.544645, 16.200294, 17.984707,
18.797649, 17.699669, 15.854421, 14.126160, 12.563268, 11.234962,
10.233016, 9.659523, 10.039643, 10.940327, 12.193796, 13.703575,
15.394443, 17.213102, 18.338720, 17.486097, 15.562881, 13.738620,
12.058267, 10.590565, 9.435289, 8.717541, 8.958572, 9.876522,
11.177732, 12.745343, 14.493170, 16.363575, 17.835352, 17.244707,
15.240876, 13.315395, 11.507661, 9.882502, 8.544736, 7.646720,
7.728214, 8.690128];
var em4d  = [19.485554, 17.236172, 14.985797, 12.735687, 10.485653, 8.235675,
5.985659, 3.735615, 1.485603, 3.014470, 5.264429, 7.514438, 9.764465,
12.014441, 14.264442, 16.514437, 18.764435, 19.485590, 17.956736,
15.706734, 13.456733, 11.206745, 8.956734, 6.706731, 4.456728,
2.206719, 2.293283, 4.543271, 6.793278, 9.043274, 11.293281,
13.543283, 15.793286, 18.043283, 19.485584, 18.677856, 16.427856,
14.177866, 11.927859, 9.677857, 7.427853, 5.177853, 2.927846,
1.572143, 3.822145, 6.072146, 8.322148, 10.572146, 12.822143,
15.072150, 17.322145, 19.485600, 19.399010, 17.149002, 14.899003,
12.649005, 10.399002, 8.149005, 5.898999, 3.649017, 1.399018,
3.100984, 5.350988, 7.600991, 9.850988, 12.100986, 14.350993,
16.600990, 18.850981, 19.485592, 17.870142, 15.620142, 13.370142,
11.120142, 8.870140, 6.620138, 4.370137, 2.120137, 2.379864, 4.629853];

var pem4x = {
x:[0., 0.00250313, 0.00500626, 0.00750939, 0.0125156, 0.0162703, 
0.0212766, 0.0250313, 0.028786, 0.0325407, 0.0362954, 0.0400501, 
0.0438048, 0.0475594, 0.0513141, 0.0550688, 0.0588235, 0.0625782, 
0.0650814, 0.068836, 0.0725907, 0.0763454, 0.0801001, 0.0838548, 
0.0876095, 0.0913642, 0.0938673, 0.097622, 0.101377, 0.105131, 
0.108886, 0.111389, 0.113892, 0.116395, 0.118899, 0.121402, 0.123905, 
0.125156, 0.12766, 0.130163, 0.133917, 0.137672, 0.141427, 0.14393, 
0.146433, 0.150188, 0.153942, 0.157697, 0.161452, 0.165207, 0.168961, 
0.172716, 0.176471, 0.180225, 0.18398, 0.187735, 0.190238, 0.193992, 
0.197747, 0.201502, 0.205257, 0.209011, 0.212766, 0.216521, 0.219024, 
0.222778, 0.226533, 0.230288, 0.234043, 0.236546, 0.239049, 0.241552, 
0.244055, 0.246558, 0.249061, 0.250313, 0.252816, 0.255319, 0.259074, 
0.261577, 0.26408, 0.267835, 0.270338, 0.272841, 0.276596, 0.28035, 
0.284105, 0.28786, 0.291615, 0.295369, 0.299124, 0.302879, 0.306633, 
0.310388, 0.314143, 0.316646, 0.320401, 0.324155, 0.32791, 0.330413, 
0.334168, 0.337922, 0.341677, 0.34418, 0.347935, 0.35169, 0.355444, 
0.359199, 0.361702, 0.364205, 0.369212, 0.374218, 0.375469, 0.377972, 
0.380476, 0.382979, 0.385482, 0.387985, 0.390488, 0.394243, 0.399249, 
0.403004, 0.406758, 0.410513, 0.414268, 0.418023, 0.421777, 0.425532, 
0.429287, 0.433041, 0.436796, 0.440551, 0.443054, 0.446809, 0.450563, 
0.454318, 0.456821, 0.460576, 0.46433, 0.468085, 0.470588, 0.474343, 
0.478098, 0.481852, 0.485607, 0.490613, 0.494368, 0.496871, 0.499374, 
0.500626, 0.505632, 0.510638, 0.513141, 0.515645, 0.519399, 0.524406, 
0.52816, 0.531915, 0.53567, 0.539424, 0.543179, 0.546934, 0.550688, 
0.554443, 0.558198, 0.561952, 0.565707, 0.56821, 0.571965, 0.57572, 
0.579474, 0.581977, 0.585732, 0.589487, 0.593242, 0.595745, 0.599499, 
0.603254, 0.607009, 0.609512, 0.612015, 0.614518, 0.618273, 0.620776, 
0.623279, 0.624531, 0.625782, 0.630788, 0.635795, 0.638298, 0.640801, 
0.644556, 0.647059, 0.649562, 0.653317, 0.657071, 0.660826, 0.664581, 
0.668335, 0.67209, 0.675845, 0.679599, 0.683354, 0.687109, 0.690864, 
0.693367, 0.697121, 0.700876, 0.704631, 0.707134, 0.710889, 0.714643, 
0.718398, 0.722153, 0.725907, 0.729662, 0.733417, 0.737171, 0.740926, 
0.744681, 0.747184, 0.749687, 0.750939, 0.753442, 0.755945, 0.758448, 
0.760951, 0.763454, 0.765957, 0.769712, 0.772215, 0.774718, 0.778473, 
0.780976, 0.783479, 0.787234, 0.790989, 0.794743, 0.798498, 0.802253, 
0.806008, 0.809762, 0.813517, 0.817272, 0.819775, 0.823529, 0.827284, 
0.831039, 0.833542, 0.837297, 0.841051, 0.844806, 0.848561, 0.852315, 
0.85607, 0.859825, 0.863579, 0.867334, 0.869837, 0.87234, 0.874844, 
0.876095, 0.878598, 0.881101, 0.883605, 0.886108, 0.888611, 0.891114, 
0.893617, 0.89612, 0.898623, 0.901126, 0.904881, 0.908636, 0.91239, 
0.916145, 0.9199, 0.923655, 0.927409, 0.931164, 0.934919, 0.938673, 
0.942428, 0.944931, 0.948686, 0.951189, 0.954944, 0.957447, 0.961202, 
0.964956, 0.968711, 0.971214, 0.974969, 0.978723, 0.982478, 0.986233, 
0.989987, 0.993742, 0.998748, 1.],
y:[19.497, 19.2293, 18.9801, 18.7383, 18.2783, 17.9548, 17.5545, 
17.2788, 17.0252, 16.7948, 16.5884, 16.4071, 16.2517, 16.1228, 
16.0212, 15.9473, 15.9016, 15.8849, 15.8955, 15.9351, 16.0029, 
16.0986, 16.2216, 16.3714, 16.5472, 16.7483, 16.8958, 17.1368, 
17.4005, 17.6859, 17.9919, 18.2069, 18.4303, 18.6618, 18.9011, 
19.1479, 19.402, 19.4024, 19.1416, 18.8878, 18.5211, 18.1718, 
17.8411, 17.6315, 17.4309, 17.1476, 16.8863, 16.6482, 16.4342, 
16.2453, 16.0823, 15.9461, 15.8373, 15.7565, 15.7042, 15.6806, 
15.6858, 15.7199, 15.7826, 15.8737, 15.9925, 16.1385, 16.3111, 
16.5092, 16.6551, 16.894, 17.1559, 17.4398, 17.7448, 17.9592, 
18.1822, 18.4134, 18.6525, 18.8993, 19.1533, 19.1568, 18.8894, 
18.6289, 18.252, 18.0103, 17.7766, 17.4419, 17.2297, 17.0268, 
16.7403, 16.4763, 16.2359, 16.0202, 15.8302, 15.6668, 15.5309, 
15.4232, 15.3443, 15.2946, 15.2744, 15.2839, 15.323, 15.3914, 
15.4888, 15.5695, 15.7139, 15.8855, 16.0834, 16.2296, 16.4693, 
16.7326, 17.0186, 17.3259, 17.5422, 17.7671, 18.2418, 18.7475, 
18.759, 18.4828, 18.2136, 17.9516, 17.697, 17.4503, 17.2117, 16.87, 
16.4461, 16.1537, 15.8844, 15.6395, 15.4201, 15.2273, 15.0621, 
14.9256, 14.8183, 14.7411, 14.6943, 14.6798, 14.6931, 14.7387, 
14.8147, 14.9208, 15.0079, 15.1625, 15.3451, 15.5547, 15.7089, 
15.9611, 16.2374, 16.5364, 16.857, 17.316, 17.6823, 17.9364, 18.198, 
18.225, 17.658, 17.1193, 16.8614, 16.6117, 16.2531, 15.8071, 15.4982, 
15.213, 14.9526, 14.7184, 14.5118, 14.3338, 14.1856, 14.068, 13.982, 
13.928, 13.9065, 13.9174, 13.961, 14.0367, 14.1441, 14.233, 14.3915, 
14.5795, 14.7957, 14.9549, 15.2156, 15.5011, 15.8101, 16.0285, 
16.2564, 16.4934, 16.865, 17.123, 17.3888, 17.5764, 17.5764, 16.9836, 
16.4184, 16.1472, 15.884, 15.5053, 15.2641, 15.0324, 14.7038, 
14.3992, 14.1202, 13.8683, 13.6451, 13.4519, 13.2901, 13.1608, 
13.0649, 13.0034, 12.9765, 12.9845, 13.0275, 13.1049, 13.2163, 
13.309, 13.4749, 13.672, 13.899, 14.1544, 14.4367, 14.7445, 15.076, 
15.4299, 15.8046, 16.1986, 16.4713, 16.7517, 16.8399, 16.5253, 
16.2171, 15.9155, 15.6211, 15.3342, 15.0552, 14.6526, 14.3954, 
14.1479, 13.7957, 13.5744, 13.3645, 13.0724, 12.809, 12.5763, 
12.3759, 12.2095, 12.0784, 11.9838, 11.9266, 11.9094, 11.9261, 
11.9829, 12.077, 12.2076, 12.3144, 12.5032, 12.7249, 12.9778, 
13.2602, 13.5702, 13.9059, 14.2656, 14.6475, 15.0498, 15.3287, 
15.6155, 15.9097, 16.0466, 15.7153, 15.3899, 15.071, 14.7588, 
14.4539, 14.1566, 13.8676, 13.5872, 13.3161, 13.0549, 12.6828, 
12.3364, 12.0177, 11.7293, 11.4732, 11.2517, 11.0668, 10.9206, 
10.8144, 10.7495, 10.7284, 10.7461, 10.8077, 10.8717, 11.0016, 
11.1101, 11.3044, 11.5348, 11.7994, 11.9935, 12.3098, 12.6541,
13.0241, 13.4178, 13.8333, 14.2684, 14.875, 15.0055],
name: 'x'
};

var pem4xy = {
x:[0., 0.00125156, 0.00500626, 0.0100125, 0.0137672, 0.0175219, 
0.0212766, 0.0250313, 0.0275344, 0.0312891, 0.0337922, 0.0362954, 
0.0387985, 0.0425532, 0.0450563, 0.0475594, 0.0500626, 0.0525657, 
0.0550688, 0.057572, 0.0600751, 0.0625782, 0.0650814, 0.0675845, 
0.0700876, 0.0750939, 0.0788486, 0.0838548, 0.0876095, 0.0913642, 
0.0938673, 0.0963705, 0.100125, 0.102628, 0.105131, 0.110138, 
0.115144, 0.12015, 0.125156, 0.12766, 0.130163, 0.132666, 0.135169, 
0.137672, 0.140175, 0.142678, 0.146433, 0.148936, 0.152691, 0.156446, 
0.1602, 0.163955, 0.16771, 0.171464, 0.175219, 0.176471, 0.177722, 
0.181477, 0.185232, 0.188986, 0.192741, 0.196496, 0.20025, 0.204005, 
0.206508, 0.210263, 0.212766, 0.215269, 0.217772, 0.220275, 0.222778, 
0.225282, 0.227785, 0.230288, 0.232791, 0.235294, 0.237797, 0.242804, 
0.24781, 0.252816, 0.256571, 0.259074, 0.261577, 0.265332, 0.269086, 
0.271589, 0.274093, 0.277847, 0.28035, 0.282854, 0.28786, 0.292866, 
0.295369, 0.297872, 0.300375, 0.302879, 0.305382, 0.307885, 0.310388, 
0.314143, 0.316646, 0.319149, 0.321652, 0.325407, 0.32791, 0.331665, 
0.334168, 0.337922, 0.340426, 0.34418, 0.347935, 0.35169, 0.352941, 
0.354193, 0.359199, 0.362954, 0.366708, 0.370463, 0.374218, 0.377972, 
0.381727, 0.385482, 0.389237, 0.39174, 0.394243, 0.396746, 0.401752, 
0.406758, 0.411765, 0.416771, 0.421777, 0.425532, 0.430538, 0.434293, 
0.436796, 0.439299, 0.443054, 0.446809, 0.451815, 0.455569, 0.460576, 
0.46433, 0.469337, 0.474343, 0.479349, 0.484355, 0.489362, 0.491865, 
0.494368, 0.496871, 0.500626, 0.503129, 0.506884, 0.510638, 0.514393, 
0.518148, 0.521902, 0.525657, 0.529412, 0.530663, 0.531915, 0.534418, 
0.536921, 0.540676, 0.543179, 0.545682, 0.549437, 0.553191, 0.555695, 
0.559449, 0.561952, 0.565707, 0.56821, 0.570713, 0.573217, 0.576971, 
0.579474, 0.581977, 0.584481, 0.589487, 0.594493, 0.599499, 0.603254, 
0.60826, 0.612015, 0.617021, 0.620776, 0.624531, 0.629537, 0.633292, 
0.635795, 0.638298, 0.642053, 0.647059, 0.649562, 0.652065, 0.654568, 
0.657071, 0.659574, 0.662078, 0.664581, 0.668335, 0.670839, 0.673342, 
0.675845, 0.679599, 0.682103, 0.685857, 0.68836, 0.692115, 0.694618, 
0.698373, 0.702128, 0.705882, 0.707134, 0.708385, 0.713392, 0.717146, 
0.71965, 0.722153, 0.725907, 0.729662, 0.733417, 0.737171, 0.740926, 
0.744681, 0.747184, 0.749687, 0.75219, 0.757196, 0.7597, 0.762203, 
0.764706, 0.767209, 0.769712, 0.772215, 0.774718, 0.777222, 0.780976, 
0.785982, 0.789737, 0.793492, 0.797247, 0.801001, 0.804756, 0.808511, 
0.813517, 0.817272, 0.819775, 0.822278, 0.827284, 0.83229, 0.837297, 
0.842303, 0.844806, 0.847309, 0.849812, 0.853567, 0.85607, 0.859825, 
0.863579, 0.867334, 0.871089, 0.874844, 0.878598, 0.883605, 0.884856, 
0.886108, 0.891114, 0.894869, 0.899875, 0.90363, 0.907384, 0.911139, 
0.914894, 0.917397, 0.921151, 0.923655, 0.927409, 0.929912, 0.933667, 
0.93617, 0.938673, 0.941176, 0.946183, 0.949937, 0.954944, 0.958698, 
0.963705, 0.967459, 0.971214, 0.974969, 0.977472, 0.979975, 0.982478, 
0.986233, 0.988736, 0.992491, 0.994994, 1.],
y:[19.5017, 19.3025, 18.758, 18.0457, 17.5224, 17.0101, 16.5094, 
16.0213, 15.7036, 15.2395, 14.9389, 14.6459, 14.361, 13.95, 13.6874, 
13.4349, 13.1928, 12.9617, 12.7423, 12.5352, 12.341, 12.1602, 
11.9936, 11.8417, 11.7051, 11.4798, 11.3546, 11.2486, 11.2157, 
11.2348, 11.2713, 11.3254, 11.4393, 11.5365, 11.6502, 11.9252, 
12.2601, 12.6501, 13.0902, 13.3275, 13.5756, 13.8338, 14.1016, 
14.3785, 14.6639, 14.9573, 15.4116, 15.7231, 16.2027, 16.6956, 
17.2009, 17.7173, 18.2441, 18.7802, 19.325, 19.4031, 19.2958, 
18.7441, 18.2008, 17.6664, 17.1418, 16.6281, 16.1261, 15.6371, 
15.3189, 14.8543, 14.5536, 14.2608, 13.9763, 13.7006, 13.4343, 
13.178, 12.9322, 12.6975, 12.4746, 12.2641, 12.0667, 11.7136, 
11.4205, 11.1921, 11.0657, 11.0035, 10.9595, 10.9278, 10.95, 10.9888, 
11.0456, 11.1644, 11.2652, 11.383, 11.6669, 12.0115, 12.2049, 
12.4117, 12.631, 12.8623, 13.1049, 13.3583, 13.6217, 14.0346, 
14.3209, 14.6153, 14.9175, 15.3843, 15.7039, 16.1947, 16.5292, 
17.0407, 17.3879, 17.9172, 18.4559, 19.0033, 19.1652, 19.1355, 
18.3864, 17.8337, 17.2896, 16.7549, 16.2307, 15.7178, 15.2176, 
14.7312, 14.2601, 13.9553, 13.6584, 13.3701, 12.8213, 12.3138, 
11.8527, 11.4437, 11.0927, 10.8708, 10.6344, 10.5041, 10.4406, 
10.3962, 10.3657, 10.3932, 10.4978, 10.6256, 10.8589, 11.0787, 
11.427, 11.8336, 12.2925, 12.7981, 13.3452, 13.6328, 13.9289, 14.233, 
14.7032, 15.0252, 15.5202, 16.0282, 16.5482, 17.0788, 17.6194, 
18.1688, 18.7264, 18.7976, 18.6554, 18.2708, 17.8892, 17.323, 
16.9499, 16.5806, 16.0343, 15.4981, 15.1468, 14.6298, 14.2925, 
13.7985, 13.4778, 13.1647, 12.8596, 12.4185, 12.1364, 11.8645, 
11.6038, 11.1184, 10.6868, 10.3156, 10.0809, 9.83145, 9.69498, 
9.58403, 9.55673, 9.59164, 9.71109, 9.85369, 9.97298, 10.1109, 
10.3509, 10.7286, 10.9403, 11.1661, 11.4052, 11.6566, 11.9198, 
12.1938, 12.478, 12.9219, 13.2287, 13.5434, 13.8655, 14.3616, 
14.7002, 15.2189, 15.5712, 16.1089, 16.4729, 17.0266, 17.5887, 
18.1584, 18.3387, 18.2762, 17.4861, 16.9007, 16.5142, 16.131, 
15.5629, 15.0035, 14.454, 13.9155, 13.3892, 12.8768, 12.5437, 
12.2181, 11.9005, 11.2924, 11.0032, 10.7252, 10.459, 10.2058, 9.9664, 
9.74186, 9.53327, 9.34166, 9.08847, 8.82002, 8.67458, 8.57984, 
8.53747, 8.56365, 8.64484, 8.77723, 9.02941, 9.2714, 9.45605, 9.6581, 
10.1102, 10.6193, 11.1777, 11.7784, 12.0925, 12.4151, 12.7453, 
13.2539, 13.6009, 14.1323, 14.6754, 15.2291, 15.7921, 16.3636, 
16.9426, 17.7251, 17.8353, 17.6525, 16.839, 16.2347, 15.4382, 
14.8485, 14.2663, 13.6926, 13.1285, 12.7583, 12.2132, 11.8571, 
11.3355, 10.997, 10.505, 10.1885, 9.88243, 9.58768, 9.03653, 8.66152, 
8.22122, 7.94193, 7.64671, 7.48876, 7.38927, 7.35141, 7.37365,
7.42311, 7.49924, 7.66166, 7.80054, 8.05149, 8.24527, 8.66913],
name: 'xy'
};

var pem4d = {
x:[0., 0.00375469, 0.00625782, 0.0137672, 0.0150188, 0.0162703, 
0.0312891, 0.107635, 0.108886, 0.151439, 0.215269, 0.216521, 
0.217772, 0.26408, 0.309136, 0.321652, 0.324155, 0.325407, 0.399249, 
0.419274, 0.428035, 0.43179, 0.433041, 0.434293, 0.519399, 0.540676, 
0.541927, 0.602003, 0.628285, 0.637046, 0.64831, 0.649562, 0.650814, 
0.724656, 0.745932, 0.754693, 0.757196, 0.758448, 0.765957, 0.77597, 
0.778473, 0.864831, 0.866083, 0.867334, 0.937422, 0.961202, 0.963705, 
0.973717, 0.974969, 1.],
y:[19.5053, 18.8103, 18.3607, 17.0104, 16.7857, 16.5605, 13.8606, 
0.135535, 0.314432, 7.96439, 19.4394, 19.4856, 19.3067, 10.9817, 
2.8817, 0.631728, 0.1817, 0.268271, 13.5433, 17.1432, 18.7183, 
19.3933, 19.4856, 19.3528, 4.05285, 0.227833, 0.222132, 11.0221, 
15.7471, 17.3221, 19.3471, 19.4856, 19.399, 6.12398, 2.29902, 
0.72398, 0.274013, 0.175988, 1.52595, 3.32599, 3.77595, 19.301, 
19.4856, 19.4451, 6.8451, 2.57, 2.1201, 0.319988, 0.129842, 4.59034],
name: 'd'
};

var pem4g = {
x:[0., 0.00876095, 0.0162703, 0.0212766, 0.0250313, 0.0325407, 
0.0400501, 0.0475594, 0.0550688, 0.0625782, 0.068836, 0.0763454, 
0.0838548, 0.0913642, 0.0988736, 0.102628, 0.107635, 0.115144, 
0.118899, 0.123905, 0.125156, 0.133917, 0.142678, 0.148936, 0.155194, 
0.162703, 0.168961, 0.175219, 0.176471, 0.177722, 0.182728, 0.187735, 
0.193992, 0.198999, 0.202753, 0.20776, 0.215269, 0.216521, 0.222778, 
0.226533, 0.230288, 0.239049, 0.244055, 0.249061, 0.250313, 0.257822, 
0.26408, 0.265332, 0.272841, 0.277847, 0.279099, 0.28035, 0.285357, 
0.292866, 0.299124, 0.30413, 0.305382, 0.309136, 0.31164, 0.320401, 
0.326658, 0.330413, 0.331665, 0.336671, 0.341677, 0.345432, 0.352941, 
0.354193, 0.362954, 0.364205, 0.370463, 0.372966, 0.375469, 0.377972, 
0.385482, 0.394243, 0.395494, 0.403004, 0.404255, 0.40801, 0.414268, 
0.423029, 0.42428, 0.43179, 0.433041, 0.434293, 0.441802, 0.450563, 
0.458073, 0.466834, 0.468085, 0.476846, 0.478098, 0.481852, 0.486859, 
0.494368, 0.499374, 0.50438, 0.506884, 0.514393, 0.515645, 0.516896, 
0.524406, 0.530663, 0.536921, 0.544431, 0.545682, 0.553191, 0.559449, 
0.564456, 0.573217, 0.578223, 0.585732, 0.586984, 0.589487, 0.596996, 
0.599499, 0.607009, 0.609512, 0.613267, 0.620776, 0.625782, 0.630788, 
0.637046, 0.643304, 0.649562, 0.650814, 0.658323, 0.660826, 0.662078, 
0.669587, 0.670839, 0.673342, 0.682103, 0.685857, 0.689612, 0.697121, 
0.699625, 0.707134, 0.710889, 0.717146, 0.718398, 0.71965, 0.722153, 
0.729662, 0.73592, 0.743429, 0.750939, 0.75219, 0.760951, 0.769712, 
0.770964, 0.772215, 0.779725, 0.784731, 0.787234, 0.794743, 0.797247, 
0.79975, 0.801001, 0.802253, 0.808511, 0.813517, 0.819775, 0.821026, 
0.822278, 0.827284, 0.83229, 0.8398, 0.846058, 0.853567, 0.85607, 
0.859825, 0.864831, 0.866083, 0.873592, 0.878598, 0.883605, 0.892365, 
0.893617, 0.899875, 0.904881, 0.913642, 0.918648, 0.927409, 0.928661, 
0.934919, 0.94368, 0.944931, 0.946183, 0.952441, 0.953692, 0.961202, 
0.968711, 0.97622, 0.977472, 0.978723, 0.986233, 0.994994, 1.],
y:[19.4856, 18.6207, 17.955, 17.5546, 17.2789, 16.7948, 16.4072, 
16.1228, 15.9474, 15.8849, 15.9351, 16.0986, 16.3715, 16.7483, 
17.2223, 17.4933, 17.8877, 18.5451, 18.9011, 19.4024, 19.4024, 
18.5211, 17.7352, 17.2396, 16.8044, 17.6335, 18.4415, 19.325, 
19.3989, 19.2954, 18.5991, 17.9723, 17.2962, 16.8368, 17.3006, 
18.1126, 19.4394, 19.4856, 18.4236, 17.8558, 17.4399, 18.1822, 
18.6525, 19.1568, 19.1568, 18.3758, 17.7766, 17.8047, 18.5817, 
19.1413, 19.236, 19.1774, 18.5901, 17.7858, 18.461, 19.1519, 19.2287, 
19.0262, 18.6242, 17.5974, 17.0468, 16.5662, 16.5412, 17.0557, 
17.6432, 18.128, 19.1632, 19.1325, 17.905, 17.8645, 18.7722, 19.1733, 
19.2455, 19.006, 17.9451, 18.8783, 18.9219, 18.0986, 18.0498, 
18.2562, 19.1079, 18.0748, 18.0748, 19.3933, 19.4856, 19.3529, 
18.0834, 18.9309, 18.051, 19.1671, 19.1241, 18.0457, 17.9426, 
17.3905, 16.9685, 17.6823, 18.225, 17.8332, 18.1506, 19.3051, 
18.4663, 19.1395, 18.1379, 18.792, 18.0173, 19.0642, 19.0619, 
17.9782, 18.5683, 17.9558, 18.8724, 18.2683, 19.2658, 19.2431, 
18.9954, 17.7833, 17.4555, 18.3762, 18.8082, 19.0959, 17.9742, 
18.519, 18.0513, 18.9001, 18.4481, 19.4856, 19.399, 18.0747, 17.6973, 
17.7029, 18.6898, 18.9438, 19.1635, 18.1339, 18.3925, 17.8725, 
16.9302, 17.2371, 18.3304, 17.8936, 18.6518, 17.8332, 18.6735, 
18.3246, 19.312, 18.4096, 18.1792, 19.0707, 18.9531, 17.6136, 
18.8173, 17.6539, 18.8858, 17.6908, 17.0775, 17.2965, 18.4572, 
18.9092, 19.2657, 18.0242, 19.1879, 18.2717, 18.2065, 19.1071, 
17.1461, 18.9367, 18.1437, 18.0361, 18.8567, 17.9311, 17.5033, 
17.7954, 18.4096, 19.301, 19.4856, 18.3642, 18.4541, 19.1561, 
18.1601, 18.3556, 17.4019, 17.3996, 18.0804, 18.7902, 17.6516, 
17.6693, 18.5229, 19.2135, 17.7212, 19.1841, 18.1434, 18.1502, 
19.1821, 17.9703, 18.8585, 17.5138, 18.7911, 18.0071, 16.6646, 
17.3658],
name: 'global'
};


var data5  = [pem4g,pem4x,pem4xy,pem4d];

Plotly.newPlot('fig5', data5,  layout4, {displaylogo: false, autosizable: true});

var hars30d = [ 0.158276, 0.158297, 0.158332, 0.158388, 0.158454, 0.158538, 0.158637, 0.158748, 0.158876, 0.159019, 0.159199, 0.159375, 0.159568, 0.159777, 0.160001, 0.160239, 0.160500, 0.160770, 0.161067, 0.161370, 0.161696, 0.162046, 0.162393, 0.162774, 0.163121, 0.163544, 0.163964, 0.164423, 0.164902, 0.165394, 0.165843, 0.166381, 0.166938, 0.167511, 0.168041, 0.168662, 0.169310, 0.169894, 0.170603, 0.171326, 0.171975, 0.172756, 0.173468, 0.174288, 0.175050, 0.175813, 0.176722, 0.177561, 0.178569, 0.179444, 0.180370, 0.181313, 0.182305, 0.183471, 0.184520, 0.185608, 0.186742, 0.187898, 0.189114, 0.190359, 0.191649, 0.192964, 0.194123, 0.195542, 0.197024, 0.198568, 0.199889, 0.201583, 0.202928, 0.204760, 0.206227, 0.208142, 0.209800, 0.211485, 0.213612, 0.215416, 0.217359, 0.219344, 0.221380, 0.223702];
var hars30x = [0.287103, 0.279502, 0.277061, 0.276113, 0.275596, 0.275257, 0.275007, 0.274803, 0.274628, 0.274470, 0.274319, 0.274149, 0.274005, 0.273863, 0.273709, 0.273562, 0.273405, 0.273245, 0.273085, 0.272914, 0.272740, 0.272558, 0.272376, 0.272190, 0.271997, 0.271829, 0.271626, 0.271421, 0.271207, 0.270997, 0.270781, 0.270596, 0.270370, 0.270153, 0.269930, 0.269729, 0.269507, 0.269278, 0.269080, 0.268859, 0.268636, 0.268449, 0.268235, 0.268057, 0.267842, 0.267672, 0.267514, 0.267316, 0.267162, 0.267000, 0.266867, 0.266738, 0.266632, 0.266520, 0.266419, 0.266356, 0.266296, 0.266270, 0.266260, 0.266266, 0.266325, 0.266406, 0.266482, 0.266613, 0.266764, 0.266988, 0.267175, 0.267428, 0.267719, 0.268073, 0.268424, 0.268866, 0.269303, 0.269782, 0.270413, 0.271019, 0.271655, 0.272343, 0.273125, 0.274112];

var hars30dt = {y:hars30d, x:bax, name:'h-angle+rs (D)' };
var hars30xt = {y:hars30x, x:bax, name:'h-angle+rs (X)' };



// half-angle + radial stretch
var hars30 = [0.289126, 0.289097, 0.288748, 0.288598, 0.287890, 0.288627, 0.288176,0.288581, 0.288244, 0.288723, 0.288313, 0.290271, 0.287826, 0.287259,0.288415, 0.287544, 0.292087, 0.289292, 0.286854, 0.287056, 0.288884,0.286394, 0.286060, 0.286475, 0.285624, 0.285219, 0.288606, 0.284806,0.285642, 0.287220, 0.284705, 0.284665, 0.284308, 0.285674, 0.284104,0.284928, 0.283270, 0.282177, 0.284462, 0.284764, 0.283340, 0.281653,0.282597, 0.283716, 0.282226, 0.281744, 0.280090, 0.280514, 0.278921,0.278677, 0.281823, 0.280418, 0.281653, 0.278646, 0.279244, 0.278603,0.277384, 0.277037, 0.278750, 0.278290, 0.277831, 0.276590, 0.277288,0.277347, 0.276365, 0.276332, 0.276745, 0.276920, 0.278003, 0.277905,0.278440, 0.278310, 0.277381, 0.279211, 0.279532, 0.279570, 0.280667,0.280857, 0.280248, 0.281494];
var hars31 = [0.255575, 0.257556, 0.258579, 0.257402, 0.257815, 0.257891, 0.257798, 0.257774, 0.257562, 0.258418, 0.257843, 0.257150, 0.257551, 0.257264, 0.257876, 0.257148, 0.257856, 0.257399, 0.257439, 0.257013, 0.256982, 0.257046, 0.256700, 0.256643, 0.256187, 0.256547, 0.256310, 0.255978, 0.255884, 0.255892, 0.255996, 0.255794, 0.255324, 0.255324, 0.255570, 0.254986, 0.255222, 0.255005, 0.254801, 0.256109, 0.254552, 0.254744, 0.254587, 0.254517, 0.254365, 0.254810, 0.254381, 0.254304, 0.254267, 0.254175, 0.254829, 0.254050, 0.254421, 0.254459, 0.254311, 0.254302, 0.254331, 0.254558, 0.254932, 0.254755, 0.255038, 0.255228, 0.255219, 0.255553, 0.255826, 0.256194, 0.256664, 0.256809, 0.257678, 0.258235, 0.258298, 0.259456, 0.258633, 0.260307, 0.261227, 0.262425, 0.262684, 0.263323, 0.264451, 0.264948];
var hars32 = [0.213905, 0.212808, 0.214207, 0.214434, 0.214179, 0.214214, 0.214538, 0.214622, 0.214265, 0.214334, 0.214322, 0.214698, 0.216966, 0.214893, 0.215367, 0.215417, 0.214866, 0.214817, 0.214824, 0.216818, 0.214864, 0.215424, 0.217755, 0.216936, 0.218875, 0.217419, 0.215778, 0.216780, 0.216335, 0.217530, 0.218487, 0.218114, 0.216783, 0.218146, 0.219706, 0.218398, 0.218937, 0.218475, 0.220315, 0.219653, 0.218961, 0.221166, 0.220454, 0.219940, 0.220971, 0.221364, 0.221770, 0.221070, 0.221965, 0.222137, 0.223266, 0.223529, 0.222618, 0.224248, 0.224239, 0.225024, 0.224511, 0.225797, 0.225972, 0.226470, 0.226445, 0.227494, 0.229175, 0.230291, 0.230679, 0.229956, 0.231529, 0.232912, 0.233177, 0.233907, 0.235286, 0.235357, 0.236900, 0.238156, 0.240938, 0.240199, 0.241764, 0.243457, 0.244655, 0.246134];

var hars30t = {y:hars30, x:bax, name:'h-angle+rs' };
var hars31t = {y:hars31, x:bax, name:'h-angle+rs' };
var hars32t = {y:hars32, x:bax, name:'h-angle+rs' };

var hars30a = [hars30t,hars30xt,hars30dt];
var hars30l = [hars30t,em30t,hm30t];
var hars31l = [hars31t,em31t,hm31t];
var hars32l = [hars32t,baemm,bazxz,bahmm];

var harsLayout = {
  xaxis: { nticks: 10 },
  yaxis: { nticks: 20 },
  height: 500,
  width:  800
};

Plotly.newPlot('fig6',  hars30a, harsLayout, {displaylogo: false, autosizable: true});

Plotly.newPlot('fig6a', hars30l, harsLayout, {displaylogo: false, autosizable: true});
Plotly.newPlot('fig6b', hars31l, harsLayout, {displaylogo: false, autosizable: true});
Plotly.newPlot('fig6c', hars32l, harsLayout, {displaylogo: false, autosizable: true});

</script>
